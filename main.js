/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MentionsPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
var DEFAULT_SETTINGS = {
  debugMode: false
};
var DebugLogger = class {
  constructor(enabled = false) {
    this.enabled = enabled;
  }
  setEnabled(enabled) {
    this.enabled = enabled;
  }
  log(...args) {
    if (this.enabled) {
      console.log("[Mentions Debug]:", ...args);
    }
  }
};
var MentionsSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(plugin) {
    super(plugin.app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Debug Mode").setDesc("Enable debug logging in the console").addToggle((toggle) => toggle.setValue(this.plugin.settings.debugMode).onChange(async (value) => {
      this.plugin.settings.debugMode = value;
      this.plugin.debugLogger.setEnabled(value);
      await this.plugin.saveSettings();
    }));
  }
};
var VIEW_TYPE_MENTIONS = "mentions-view";
var MentionSuggest = class extends import_obsidian.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.plugin = plugin;
  }
  onTrigger(cursor, editor, file) {
    const line = editor.getLine(cursor.line);
    const subString = line.substring(0, cursor.ch);
    const match = subString.match(/(?:^|\s)(@[a-zA-Zа-яА-Я.-]*)$/);
    this.plugin.debugLogger.log("MentionSuggest.onTrigger:", { line, subString, match });
    if (!match)
      return null;
    return {
      start: {
        line: cursor.line,
        ch: match.index + match[0].indexOf("@")
      },
      end: cursor,
      query: match[1].slice(1)
    };
  }
  getSuggestions(context) {
    const query = context.query.toLowerCase();
    const mentions = this.plugin.getMentions();
    this.plugin.debugLogger.log("Raw mentions from plugin:", mentions);
    const uniqueMentions = new Set(mentions.map((m) => m.text));
    this.plugin.debugLogger.log("Unique mentions:", Array.from(uniqueMentions));
    const suggestions = Array.from(uniqueMentions).filter((mention) => mention.toLowerCase().includes(query)).sort();
    this.plugin.debugLogger.log("MentionSuggest.getSuggestions:", {
      query,
      mentionsCount: mentions.length,
      suggestionsCount: suggestions.length,
      suggestions,
      uniqueMentionsCount: uniqueMentions.size
    });
    return suggestions;
  }
  renderSuggestion(value, el) {
    el.createEl("div", { text: value });
  }
  selectSuggestion(value) {
    const { context } = this;
    if (context) {
      const editor = context.editor;
      editor.replaceRange(
        value + " ",
        { line: context.start.line, ch: context.start.ch },
        context.end
      );
      const newCursorPos = {
        line: context.end.line,
        ch: context.start.ch + value.length + 1
      };
      editor.setCursor(newCursorPos);
    }
  }
};
var MentionsView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.mentions = [];
    this.plugin = plugin;
  }
  getViewType() {
    return VIEW_TYPE_MENTIONS;
  }
  getIcon() {
    return "at-sign";
  }
  getDisplayText() {
    return "People mentions";
  }
  async setMentions(mentions) {
    this.mentions = mentions;
    await this.refresh();
  }
  async refresh() {
    const container = this.containerEl.children[1];
    container.empty();
    const headerContainer = container.createEl("div", { cls: "mentions-header" });
    headerContainer.createEl("h2", { text: "People mentions", cls: "mentions-title" });
    const refreshButton = headerContainer.createEl("button", {
      cls: "mentions-refresh-button",
      text: "\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",
      attr: { "aria-label": "Refresh all mentions" }
    });
    refreshButton.addEventListener("click", async () => {
      refreshButton.addClass("refreshing");
      await this.plugin.refreshAllMentions();
      refreshButton.removeClass("refreshing");
    });
    const mentionGroups = /* @__PURE__ */ new Map();
    this.mentions.forEach((mention) => {
      const existingGroup = mentionGroups.get(mention.text) || [];
      mentionGroups.set(mention.text, [...existingGroup, mention]);
    });
    const mentionsList = container.createEl("ul", { cls: "mentions-list" });
    const sortedMentions = Array.from(mentionGroups.entries()).sort(([a], [b]) => a.localeCompare(b));
    sortedMentions.forEach(([mentionText, mentions]) => {
      const uniqueFiles = new Set(mentions.map((m) => m.file));
      const fileCount = uniqueFiles.size;
      const item = mentionsList.createEl("li", { cls: "mentions-list-item" });
      item.createEl("strong", { text: mentionText });
      item.createEl("br");
      item.createEl("span", {
        text: `Found in ${fileCount} file${fileCount !== 1 ? "s" : ""}`,
        cls: "mention-file-count"
      });
      item.addEventListener("click", () => {
        const searchLeaf = this.app.workspace.getLeavesOfType("search")[0] || this.app.workspace.getRightLeaf(false);
        searchLeaf.setViewState({
          type: "search",
          state: { query: mentionText }
        });
        this.app.workspace.revealLeaf(searchLeaf);
      });
    });
  }
};
var MentionsPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.mentions = [];
    this.editorDecorations = /* @__PURE__ */ new Map();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    this.debugLogger = new DebugLogger(this.settings.debugMode);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  getMentions() {
    this.debugLogger.log("Getting mentions:", this.mentions);
    return this.mentions;
  }
  async refreshAllMentions() {
    this.debugLogger.log("Starting full mentions refresh...");
    this.mentions = [];
    const files = this.app.vault.getMarkdownFiles();
    for (const file of files) {
      const content = await this.app.vault.read(file);
      const matches = content.match(/(?:^|\s)@[a-zA-Zа-яА-Я.-]+/g);
      if (matches) {
        matches.forEach((match) => {
          const cleanMatch = match.trim();
          const position = content.indexOf(match);
          const exists = this.mentions.some(
            (m) => m.text === cleanMatch && m.file === file.path && m.position === position
          );
          if (!exists) {
            this.mentions.push({
              text: cleanMatch,
              file: file.path,
              position
            });
          }
        });
      }
    }
    this.debugLogger.log("Mentions refresh completed:", this.mentions);
    if (this.mentionsView) {
      await this.mentionsView.setMentions(this.mentions);
    }
    await this.saveData(this.mentions);
    new import_obsidian.Notice("Mentions refreshed successfully");
  }
  searchMentions(mentionText) {
    const searchText = mentionText.startsWith("@") ? mentionText : "@" + mentionText;
    console.log("Searching for mentions:", {
      searchText,
      currentMentions: this.mentions,
      matchingMentions: this.mentions.filter((mention) => {
        const cleanMention = mention.text.trim();
        return cleanMention === searchText;
      })
    });
    return this.mentions.filter((mention) => {
      const cleanMention = mention.text.trim();
      return cleanMention === searchText;
    });
  }
  async showMentionResults(mentionText) {
    console.log("Showing mention results for:", mentionText);
    const results = this.searchMentions(mentionText);
    console.log("Search results:", results);
    if (results.length > 0) {
      if (this.mentionsView) {
        await this.mentionsView.setMentions(results);
        await this.activateMentionsView();
      }
      new import_obsidian.Notice(`Found ${results.length} mentions of ${mentionText}`);
    } else {
      new import_obsidian.Notice(`No mentions found for ${mentionText}`);
    }
  }
  async activateMentionsView() {
    const { workspace } = this.app;
    let leaf = workspace.getLeavesOfType(VIEW_TYPE_MENTIONS)[0];
    if (!leaf) {
      const rightLeaf = workspace.getRightLeaf(false);
      if (rightLeaf) {
        leaf = rightLeaf;
        await leaf.setViewState({
          type: VIEW_TYPE_MENTIONS,
          active: true,
          history: false
        });
      }
    }
    if (leaf) {
      workspace.revealLeaf(leaf);
      if (this.mentionsView) {
        await this.mentionsView.setMentions(this.mentions);
      }
    }
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new MentionsSettingTab(this));
    console.log("MentionsPlugin loading...");
    const mentionStyles = document.createElement("style");
    mentionStyles.textContent = `
            .mention-tag {
                color: var(--text-accent);
                background-color: var(--background-modifier-border);
                padding: 2px 4px;
                border-radius: 4px;
                cursor: pointer;
                transition: background-color 0.2s ease;
            }
            .mention-tag:hover {
                background-color: var(--background-modifier-border-hover);
            }
            .mentions-list-item {
                padding: 8px;
                margin: 4px 0;
                border-radius: 4px;
                cursor: pointer;
                transition: background-color 0.2s ease;
            }
            .mentions-list-item:hover {
                background-color: var(--background-modifier-border);
            }
            .mention-file-count {
                color: var(--text-muted);
                font-size: 0.9em;
            }
        `;
    document.head.appendChild(mentionStyles);
    this.registerView(
      VIEW_TYPE_MENTIONS,
      (leaf) => this.mentionsView = new MentionsView(leaf, this)
    );
    this.mentionSuggest = new MentionSuggest(this);
    this.registerEditorSuggest(this.mentionSuggest);
    this.registerEditorExtension([
      this.decorateMentions()
    ]);
    this.addRibbonIcon("at-sign", "Show People mentions", () => {
      this.activateMentionsView();
    });
    this.addCommand({
      id: "show-mentions-view",
      name: "Show People mentions View",
      callback: () => {
        this.activateMentionsView();
      }
    });
    try {
      const savedMentions = await this.loadData();
      console.log("Loading mentions from storage:", {
        savedMentions,
        hasData: !!savedMentions,
        dataType: typeof savedMentions
      });
      if (savedMentions) {
        this.mentions = savedMentions;
        console.log("Mentions loaded into memory:", this.mentions);
        new import_obsidian.Notice(`Loaded ${savedMentions.length} mentions`);
      }
      console.log("Processing existing files for mentions...");
      const files = this.app.vault.getMarkdownFiles();
      for (const file of files) {
        const content = await this.app.vault.read(file);
        const matches = content.match(/(?:^|\s)@[a-zA-Zа-яА-Я.-]+/g);
        if (matches) {
          console.log(`Found mentions in ${file.path}:`, matches);
          matches.forEach((match) => {
            const cleanMatch = match.trim();
            const position = content.indexOf(match);
            const exists = this.mentions.some(
              (m) => m.text === cleanMatch && m.file === file.path && m.position === position
            );
            if (!exists) {
              this.mentions.push({
                text: cleanMatch,
                file: file.path,
                position
              });
            }
          });
        }
      }
      if (this.mentions.length > 0) {
        console.log("Initial mentions found:", this.mentions);
        if (this.mentionsView) {
          await this.mentionsView.setMentions(this.mentions);
        }
        await this.saveData(this.mentions);
      }
      const processor = async (el, ctx) => {
        var _a;
        console.log("MarkdownPostProcessor called for:", ctx.sourcePath);
        console.log("Element content:", el.innerHTML);
        console.log("Current mentions in memory:", this.mentions);
        el.querySelectorAll(".mention-tag").forEach((el2) => el2.remove());
        const codeBlocks = el.querySelectorAll("code");
        console.log("Found code blocks:", codeBlocks.length);
        codeBlocks.forEach((block) => {
          block.addClass("mentions-ignore");
        });
        const walker = document.createTreeWalker(
          el,
          NodeFilter.SHOW_TEXT,
          {
            acceptNode: function(node2) {
              var _a2, _b, _c, _d;
              const isInCodeBlock = (_a2 = node2.parentElement) == null ? void 0 : _a2.closest(".mentions-ignore");
              const isInMention = (_b = node2.parentElement) == null ? void 0 : _b.hasClass("mention-tag");
              console.log("Checking node:", {
                text: node2.textContent,
                isInCodeBlock,
                isInMention,
                parentElement: (_c = node2.parentElement) == null ? void 0 : _c.tagName,
                classList: (_d = node2.parentElement) == null ? void 0 : _d.className
              });
              if (isInCodeBlock || isInMention) {
                return NodeFilter.FILTER_REJECT;
              }
              return NodeFilter.FILTER_ACCEPT;
            }
          }
        );
        const nodesToProcess = [];
        let node;
        let nodeCount = 0;
        while (node = walker.nextNode()) {
          nodeCount++;
          const matchResult = (_a = node.textContent) == null ? void 0 : _a.match(/(?:^|\s)@[a-zA-Zа-яА-Я.-]+/g);
          console.log(`Processing node ${nodeCount}:`, {
            text: node.textContent,
            matchResult
          });
          if (matchResult && matchResult.length > 0) {
            nodesToProcess.push({ node, matches: matchResult });
          }
        }
        console.log(`Found ${nodesToProcess.length} nodes with mentions`);
        nodesToProcess.forEach(({ node: node2, matches }) => {
          let pos = 0;
          let text = node2.textContent || "";
          const fragment = document.createDocumentFragment();
          matches.forEach((match) => {
            const beforeText = text.slice(pos, text.indexOf(match, pos));
            if (beforeText) {
              fragment.append(beforeText);
            }
            const mentionEl = document.createElement("span");
            mentionEl.addClass("mention");
            mentionEl.addClass("mention-tag");
            mentionEl.textContent = match;
            mentionEl.style.cursor = "pointer";
            mentionEl.setAttribute("data-mention", match);
            const position = text.indexOf(match, pos);
            const mention = {
              text: match,
              file: ctx.sourcePath,
              position
            };
            const exists = this.mentions.some(
              (m) => m.text === match && m.file === ctx.sourcePath && m.position === position
            );
            if (!exists) {
              console.log("Adding new mention:", mention);
              this.mentions.push(mention);
              this.saveData(this.mentions);
            }
            const clickHandler = async (e) => {
              console.log("Click handler called");
              e.preventDefault();
              e.stopPropagation();
              console.log("Mention clicked:", {
                match,
                fullText: match,
                searchText: match.slice(1)
              });
              await this.showMentionResults(match.slice(1));
            };
            mentionEl.removeEventListener("click", clickHandler);
            mentionEl.addEventListener("click", clickHandler);
            fragment.append(mentionEl);
            pos = text.indexOf(match, pos) + match.length;
          });
          if (pos < text.length) {
            fragment.append(text.slice(pos));
          }
          node2.replaceWith(fragment);
        });
        if (nodesToProcess.length > 0) {
          console.log("Found new mentions, current state:", {
            newMentions: nodesToProcess.length,
            totalMentions: this.mentions.length,
            mentionsData: this.mentions
          });
          if (this.mentionsView) {
            this.mentionsView.setMentions(this.mentions);
          }
          console.log("Saving mentions to storage...");
          await this.saveData(this.mentions);
          console.log("Mentions saved successfully");
        }
      };
      this.registerMarkdownPostProcessor(processor);
      this.registerEvent(
        this.app.vault.on("modify", async (file) => {
          if (file instanceof import_obsidian.TFile && file.extension === "md") {
            console.log("File modified:", file.path);
            const content = await this.app.vault.read(file);
            console.log("Processing file content for mentions");
            this.mentions = this.mentions.filter((m) => m.file !== file.path);
            const matches = content.match(/(?:^|\s)@[a-zA-Zа-яА-Я.-]+/g);
            if (matches) {
              console.log("Found mentions in file:", matches);
              matches.forEach((match) => {
                const position = content.indexOf(match);
                this.mentions.push({
                  text: match,
                  file: file.path,
                  position
                });
              });
            }
            console.log("Updated mentions:", this.mentions);
            if (this.mentionsView) {
              await this.mentionsView.setMentions(this.mentions);
            }
            await this.saveData(this.mentions);
          }
        })
      );
      this.registerEvent(
        this.app.vault.on("delete", async (file) => {
          if (file instanceof import_obsidian.TFile && file.extension === "md") {
            console.log("File deleted:", file.path);
            const beforeCount = this.mentions.length;
            this.mentions = this.mentions.filter((m) => m.file !== file.path);
            const removedCount = beforeCount - this.mentions.length;
            if (removedCount > 0) {
              console.log(`Removed ${removedCount} mentions from deleted file:`, file.path);
              if (this.mentionsView) {
                await this.mentionsView.setMentions(this.mentions);
              }
              await this.saveData(this.mentions);
            }
          }
        })
      );
      this.registerEvent(
        this.app.vault.on("create", async (file) => {
          if (file instanceof import_obsidian.TFile && file.extension === "md") {
            console.log("New file created:", file.path);
            const content = await this.app.vault.read(file);
            const matches = content.match(/(?:^|\s)@[a-zA-Zа-яА-Я.-]+/g);
            if (matches) {
              matches.forEach((match) => {
                const position = content.indexOf(match);
                this.mentions.push({
                  text: match,
                  file: file.path,
                  position
                });
              });
              if (this.mentionsView) {
                await this.mentionsView.setMentions(this.mentions);
              }
              await this.saveData(this.mentions);
            }
          }
        })
      );
      this.registerEvent(
        this.app.vault.on("rename", async (file, oldPath) => {
          if (file instanceof import_obsidian.TFile && file.extension === "md") {
            console.log("File renamed:", { oldPath, newPath: file.path });
            this.mentions = this.mentions.map(
              (mention) => mention.file === oldPath ? { ...mention, file: file.path } : mention
            );
            if (this.mentionsView) {
              await this.mentionsView.setMentions(this.mentions);
            }
            await this.saveData(this.mentions);
          }
        })
      );
      this.registerDomEvent(document, "click", (evt) => {
        const target = evt.target;
        if (target.hasClass("mention-tag")) {
          const mentionText = target.textContent;
          if (mentionText) {
            evt.preventDefault();
            evt.stopPropagation();
            const searchLeaf = this.app.workspace.getLeavesOfType("search")[0] || this.app.workspace.getRightLeaf(false);
            searchLeaf.setViewState({
              type: "search",
              state: { query: mentionText }
            });
            this.app.workspace.revealLeaf(searchLeaf);
          }
        }
      });
      console.log("MentionsPlugin loaded successfully");
    } catch (error) {
      console.error("Error during MentionsPlugin initialization:", error);
      new import_obsidian.Notice("Error initializing Mentions plugin");
    }
  }
  onunload() {
    this.app.workspace.detachLeavesOfType(VIEW_TYPE_MENTIONS);
  }
  decorateMentions() {
    return import_state.StateField.define({
      create: () => import_view.Decoration.none,
      update: (decorations, tr) => {
        const text = tr.state.doc.toString();
        const matches = text.match(/(?:^|\s)@[a-zA-Zа-яА-Я.-]+/g);
        const decorationArray = [];
        if (matches) {
          let pos = 0;
          matches.forEach((match) => {
            const cleanMatch = match.trim();
            const start = text.indexOf(match, pos);
            if (start >= 0) {
              const end = start + match.length;
              const mentionMark = import_view.Decoration.mark({
                class: "mention mention-tag",
                attributes: { "data-mention": cleanMatch }
              });
              decorationArray.push(mentionMark.range(start, end));
              pos = end;
            }
          });
        }
        return import_view.Decoration.set(decorationArray, true);
      },
      provide: (field) => import_view.EditorView.decorations.from(field)
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgXG4gICAgUGx1Z2luLCBcbiAgICBNYXJrZG93blZpZXcsIFxuICAgIE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsXG4gICAgVEZpbGUsXG4gICAgV29ya3NwYWNlTGVhZixcbiAgICBJdGVtVmlldyxcbiAgICBWaWV3U3RhdGUsXG4gICAgRWRpdG9yU3VnZ2VzdCxcbiAgICBFZGl0b3JQb3NpdGlvbixcbiAgICBFZGl0b3IsXG4gICAgVEFic3RyYWN0RmlsZSxcbiAgICBFZGl0b3JTdWdnZXN0Q29udGV4dCxcbiAgICBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8sXG4gICAgTm90aWNlLFxuICAgIEljb25OYW1lLFxuICAgIEVkaXRvclRyYW5zYWN0aW9uLFxuICAgIE1hcmtkb3duRmlsZUluZm8sXG4gICAgZWRpdG9yVmlld0ZpZWxkLFxuICAgIFBsdWdpblNldHRpbmdUYWIsXG4gICAgU2V0dGluZ1xufSBmcm9tICdvYnNpZGlhbic7XG5cbmltcG9ydCB7IEVkaXRvclZpZXcsIERlY29yYXRpb24sIERlY29yYXRpb25TZXQsIFZpZXdVcGRhdGUgfSBmcm9tICdAY29kZW1pcnJvci92aWV3JztcbmltcG9ydCB7IFN0YXRlRmllbGQsIFN0YXRlRWZmZWN0IH0gZnJvbSAnQGNvZGVtaXJyb3Ivc3RhdGUnO1xuXG5pbnRlcmZhY2UgTWVudGlvbnNQbHVnaW5TZXR0aW5ncyB7XG4gICAgZGVidWdNb2RlOiBib29sZWFuO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBNZW50aW9uc1BsdWdpblNldHRpbmdzID0ge1xuICAgIGRlYnVnTW9kZTogZmFsc2Vcbn07XG5cbmNsYXNzIERlYnVnTG9nZ2VyIHtcbiAgICBwcml2YXRlIGVuYWJsZWQ6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihlbmFibGVkOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5lbmFibGVkID0gZW5hYmxlZDtcbiAgICB9XG5cbiAgICBzZXRFbmFibGVkKGVuYWJsZWQ6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5lbmFibGVkID0gZW5hYmxlZDtcbiAgICB9XG5cbiAgICBsb2coLi4uYXJnczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNZW50aW9ucyBEZWJ1Z106JywgLi4uYXJncyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIE1lbnRpb25zU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogTWVudGlvbnNQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1lbnRpb25zUGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGVidWcgTW9kZScpXG4gICAgICAgICAgICAuc2V0RGVzYygnRW5hYmxlIGRlYnVnIGxvZ2dpbmcgaW4gdGhlIGNvbnNvbGUnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kZWJ1Z0xvZ2dlci5zZXRFbmFibGVkKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuaW50ZXJmYWNlIE1lbnRpb24ge1xuICAgIHRleHQ6IHN0cmluZztcbiAgICBmaWxlOiBzdHJpbmc7XG4gICAgcG9zaXRpb246IG51bWJlcjtcbn1cblxuY29uc3QgVklFV19UWVBFX01FTlRJT05TID0gXCJtZW50aW9ucy12aWV3XCI7XG5cbmNsYXNzIE1lbnRpb25TdWdnZXN0IGV4dGVuZHMgRWRpdG9yU3VnZ2VzdDxzdHJpbmc+IHtcbiAgICBwbHVnaW46IE1lbnRpb25zUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZW50aW9uc1BsdWdpbikge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgb25UcmlnZ2VyKGN1cnNvcjogRWRpdG9yUG9zaXRpb24sIGVkaXRvcjogRWRpdG9yLCBmaWxlOiBURmlsZSB8IG51bGwpOiBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8gfCBudWxsIHtcbiAgICAgICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcbiAgICAgICAgY29uc3Qgc3ViU3RyaW5nID0gbGluZS5zdWJzdHJpbmcoMCwgY3Vyc29yLmNoKTtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBzdWJTdHJpbmcubWF0Y2goLyg/Ol58XFxzKShAW2EtekEtWlx1MDQzMC1cdTA0NEZcdTA0MTAtXHUwNDJGLi1dKikkLyk7XG5cbiAgICAgICAgdGhpcy5wbHVnaW4uZGVidWdMb2dnZXIubG9nKCdNZW50aW9uU3VnZ2VzdC5vblRyaWdnZXI6JywgeyBsaW5lLCBzdWJTdHJpbmcsIG1hdGNoIH0pO1xuXG4gICAgICAgIGlmICghbWF0Y2gpIHJldHVybiBudWxsO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydDoge1xuICAgICAgICAgICAgICAgIGxpbmU6IGN1cnNvci5saW5lLFxuICAgICAgICAgICAgICAgIGNoOiBtYXRjaC5pbmRleCEgKyBtYXRjaFswXS5pbmRleE9mKCdAJyksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW5kOiBjdXJzb3IsXG4gICAgICAgICAgICBxdWVyeTogbWF0Y2hbMV0uc2xpY2UoMSksXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMoY29udGV4dDogRWRpdG9yU3VnZ2VzdENvbnRleHQpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gY29udGV4dC5xdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBtZW50aW9ucyA9IHRoaXMucGx1Z2luLmdldE1lbnRpb25zKCk7XG4gICAgICAgIHRoaXMucGx1Z2luLmRlYnVnTG9nZ2VyLmxvZygnUmF3IG1lbnRpb25zIGZyb20gcGx1Z2luOicsIG1lbnRpb25zKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHVuaXF1ZU1lbnRpb25zID0gbmV3IFNldChtZW50aW9ucy5tYXAobSA9PiBtLnRleHQpKTtcbiAgICAgICAgdGhpcy5wbHVnaW4uZGVidWdMb2dnZXIubG9nKCdVbmlxdWUgbWVudGlvbnM6JywgQXJyYXkuZnJvbSh1bmlxdWVNZW50aW9ucykpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBBcnJheS5mcm9tKHVuaXF1ZU1lbnRpb25zKVxuICAgICAgICAgICAgLmZpbHRlcihtZW50aW9uID0+IG1lbnRpb24udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkpXG4gICAgICAgICAgICAuc29ydCgpO1xuXG4gICAgICAgIHRoaXMucGx1Z2luLmRlYnVnTG9nZ2VyLmxvZygnTWVudGlvblN1Z2dlc3QuZ2V0U3VnZ2VzdGlvbnM6JywgeyBcbiAgICAgICAgICAgIHF1ZXJ5LCBcbiAgICAgICAgICAgIG1lbnRpb25zQ291bnQ6IG1lbnRpb25zLmxlbmd0aCxcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zQ291bnQ6IHN1Z2dlc3Rpb25zLmxlbmd0aCxcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLFxuICAgICAgICAgICAgdW5pcXVlTWVudGlvbnNDb3VudDogdW5pcXVlTWVudGlvbnMuc2l6ZVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiB2YWx1ZSB9KTtcbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0IH0gPSB0aGlzO1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gY29udGV4dC5lZGl0b3I7XG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKFxuICAgICAgICAgICAgICAgIHZhbHVlICsgJyAnLFxuICAgICAgICAgICAgICAgIHsgbGluZTogY29udGV4dC5zdGFydC5saW5lLCBjaDogY29udGV4dC5zdGFydC5jaCB9LFxuICAgICAgICAgICAgICAgIGNvbnRleHQuZW5kXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBuZXdDdXJzb3JQb3MgPSB7XG4gICAgICAgICAgICAgICAgbGluZTogY29udGV4dC5lbmQubGluZSxcbiAgICAgICAgICAgICAgICBjaDogY29udGV4dC5zdGFydC5jaCArIHZhbHVlLmxlbmd0aCArIDFcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKG5ld0N1cnNvclBvcyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIE1lbnRpb25zVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcbiAgICBtZW50aW9uczogTWVudGlvbltdID0gW107XG4gICAgcGx1Z2luOiBNZW50aW9uc1BsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogTWVudGlvbnNQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIobGVhZik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGdldFZpZXdUeXBlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBWSUVXX1RZUEVfTUVOVElPTlM7XG4gICAgfVxuXG4gICAgZ2V0SWNvbigpOiBJY29uTmFtZSB7XG4gICAgICAgIHJldHVybiBcImF0LXNpZ25cIjtcbiAgICB9XG4gICAgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIFwiUGVvcGxlIG1lbnRpb25zXCI7XG4gICAgfVxuXG4gICAgYXN5bmMgc2V0TWVudGlvbnMobWVudGlvbnM6IE1lbnRpb25bXSkge1xuICAgICAgICB0aGlzLm1lbnRpb25zID0gbWVudGlvbnM7XG4gICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaCgpO1xuICAgIH1cblxuICAgIGFzeW5jIHJlZnJlc2goKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV07XG4gICAgICAgIGNvbnRhaW5lci5lbXB0eSgpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBoZWFkZXIgY29udGFpbmVyIHdpdGggdGl0bGUgYW5kIHJlZnJlc2ggYnV0dG9uXG4gICAgICAgIGNvbnN0IGhlYWRlckNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZW50aW9ucy1oZWFkZXJcIiB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCB0aXRsZVxuICAgICAgICBoZWFkZXJDb250YWluZXIuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiUGVvcGxlIG1lbnRpb25zXCIsIGNsczogXCJtZW50aW9ucy10aXRsZVwiIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHJlZnJlc2ggYnV0dG9uIHdpdGggdGV4dCBpbnN0ZWFkIG9mIGljb25cbiAgICAgICAgY29uc3QgcmVmcmVzaEJ1dHRvbiA9IGhlYWRlckNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7IFxuICAgICAgICAgICAgY2xzOiBcIm1lbnRpb25zLXJlZnJlc2gtYnV0dG9uXCIsXG4gICAgICAgICAgICB0ZXh0OiBcIlx1MDQxRVx1MDQzMVx1MDQzRFx1MDQzRVx1MDQzMlx1MDQzOFx1MDQ0Mlx1MDQ0Q1wiLFxuICAgICAgICAgICAgYXR0cjogeyAnYXJpYS1sYWJlbCc6ICdSZWZyZXNoIGFsbCBtZW50aW9ucycgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHJlZnJlc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHJlZnJlc2hCdXR0b24uYWRkQ2xhc3MoXCJyZWZyZXNoaW5nXCIpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4ucmVmcmVzaEFsbE1lbnRpb25zKCk7XG4gICAgICAgICAgICByZWZyZXNoQnV0dG9uLnJlbW92ZUNsYXNzKFwicmVmcmVzaGluZ1wiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gR3JvdXAgbWVudGlvbnMgYnkgdGV4dFxuICAgICAgICBjb25zdCBtZW50aW9uR3JvdXBzID0gbmV3IE1hcDxzdHJpbmcsIE1lbnRpb25bXT4oKTtcbiAgICAgICAgdGhpcy5tZW50aW9ucy5mb3JFYWNoKG1lbnRpb24gPT4ge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdHcm91cCA9IG1lbnRpb25Hcm91cHMuZ2V0KG1lbnRpb24udGV4dCkgfHwgW107XG4gICAgICAgICAgICBtZW50aW9uR3JvdXBzLnNldChtZW50aW9uLnRleHQsIFsuLi5leGlzdGluZ0dyb3VwLCBtZW50aW9uXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG1lbnRpb25zTGlzdCA9IGNvbnRhaW5lci5jcmVhdGVFbChcInVsXCIsIHsgY2xzOiBcIm1lbnRpb25zLWxpc3RcIiB9KTtcblxuICAgICAgICAvLyBTb3J0IG1lbnRpb25zIGFscGhhYmV0aWNhbGx5XG4gICAgICAgIGNvbnN0IHNvcnRlZE1lbnRpb25zID0gQXJyYXkuZnJvbShtZW50aW9uR3JvdXBzLmVudHJpZXMoKSkuc29ydCgoW2FdLCBbYl0pID0+IGEubG9jYWxlQ29tcGFyZShiKSk7XG5cbiAgICAgICAgc29ydGVkTWVudGlvbnMuZm9yRWFjaCgoW21lbnRpb25UZXh0LCBtZW50aW9uc10pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHVuaXF1ZUZpbGVzID0gbmV3IFNldChtZW50aW9ucy5tYXAobSA9PiBtLmZpbGUpKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDb3VudCA9IHVuaXF1ZUZpbGVzLnNpemU7XG5cbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBtZW50aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7IGNsczogXCJtZW50aW9ucy1saXN0LWl0ZW1cIiB9KTtcbiAgICAgICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJzdHJvbmdcIiwgeyB0ZXh0OiBtZW50aW9uVGV4dCB9KTtcbiAgICAgICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJiclwiKTtcbiAgICAgICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJzcGFuXCIsIHsgXG4gICAgICAgICAgICAgICAgdGV4dDogYEZvdW5kIGluICR7ZmlsZUNvdW50fSBmaWxlJHtmaWxlQ291bnQgIT09IDEgPyAncycgOiAnJ31gLFxuICAgICAgICAgICAgICAgIGNsczogXCJtZW50aW9uLWZpbGUtY291bnRcIiBcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gT3BlbiBzZWFyY2ggcGFuZWwgd2l0aCB0aGUgbWVudGlvbiB0ZXh0XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VhcmNoTGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ3NlYXJjaCcpWzBdIHx8IFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc2VhcmNoTGVhZi5zZXRWaWV3U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VhcmNoJyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGU6IHsgcXVlcnk6IG1lbnRpb25UZXh0IH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihzZWFyY2hMZWFmKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lbnRpb25zUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBwcml2YXRlIG1lbnRpb25zVmlldzogTWVudGlvbnNWaWV3O1xuICAgIHByaXZhdGUgbWVudGlvbnM6IE1lbnRpb25bXSA9IFtdO1xuICAgIHByaXZhdGUgbWVudGlvblN1Z2dlc3Q6IE1lbnRpb25TdWdnZXN0O1xuICAgIHByaXZhdGUgZWRpdG9yRGVjb3JhdGlvbnM6IE1hcDxzdHJpbmcsIERlY29yYXRpb25TZXQ+ID0gbmV3IE1hcCgpO1xuICAgIHNldHRpbmdzOiBNZW50aW9uc1BsdWdpblNldHRpbmdzO1xuICAgIGRlYnVnTG9nZ2VyOiBEZWJ1Z0xvZ2dlcjtcblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgICAgIHRoaXMuZGVidWdMb2dnZXIgPSBuZXcgRGVidWdMb2dnZXIodGhpcy5zZXR0aW5ncy5kZWJ1Z01vZGUpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBnZXRNZW50aW9ucygpOiBNZW50aW9uW10ge1xuICAgICAgICB0aGlzLmRlYnVnTG9nZ2VyLmxvZygnR2V0dGluZyBtZW50aW9uczonLCB0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWVudGlvbnM7XG4gICAgfVxuXG4gICAgYXN5bmMgcmVmcmVzaEFsbE1lbnRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmRlYnVnTG9nZ2VyLmxvZygnU3RhcnRpbmcgZnVsbCBtZW50aW9ucyByZWZyZXNoLi4uJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhciBleGlzdGluZyBtZW50aW9uc1xuICAgICAgICB0aGlzLm1lbnRpb25zID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBQcm9jZXNzIGFsbCBtYXJrZG93biBmaWxlc1xuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBjb250ZW50Lm1hdGNoKC8oPzpefFxccylAW2EtekEtWlx1MDQzMC1cdTA0NEZcdTA0MTAtXHUwNDJGLi1dKy9nKTtcbiAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgICAgICAgbWF0Y2hlcy5mb3JFYWNoKG1hdGNoID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xlYW5NYXRjaCA9IG1hdGNoLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBjb250ZW50LmluZGV4T2YobWF0Y2gpO1xuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGFkZCBpZiBub3QgYWxyZWFkeSBleGlzdHNcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RzID0gdGhpcy5tZW50aW9ucy5zb21lKG0gPT4gXG4gICAgICAgICAgICAgICAgICAgICAgICBtLnRleHQgPT09IGNsZWFuTWF0Y2ggJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICBtLmZpbGUgPT09IGZpbGUucGF0aCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgIG0ucG9zaXRpb24gPT09IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGNsZWFuTWF0Y2gsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZTogZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kZWJ1Z0xvZ2dlci5sb2coJ01lbnRpb25zIHJlZnJlc2ggY29tcGxldGVkOicsIHRoaXMubWVudGlvbnMpO1xuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIHZpZXcgYW5kIHNhdmUgZGF0YVxuICAgICAgICBpZiAodGhpcy5tZW50aW9uc1ZpZXcpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubWVudGlvbnNWaWV3LnNldE1lbnRpb25zKHRoaXMubWVudGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5tZW50aW9ucyk7XG4gICAgICAgIFxuICAgICAgICBuZXcgTm90aWNlKCdNZW50aW9ucyByZWZyZXNoZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfVxuXG4gICAgc2VhcmNoTWVudGlvbnMobWVudGlvblRleHQ6IHN0cmluZyk6IE1lbnRpb25bXSB7XG4gICAgICAgIC8vIFJlbW92ZSBAIHN5bWJvbCBpZiBwcmVzZW50XG4gICAgICAgIGNvbnN0IHNlYXJjaFRleHQgPSBtZW50aW9uVGV4dC5zdGFydHNXaXRoKCdAJykgPyBtZW50aW9uVGV4dCA6ICdAJyArIG1lbnRpb25UZXh0O1xuICAgICAgICBjb25zb2xlLmxvZygnU2VhcmNoaW5nIGZvciBtZW50aW9uczonLCB7XG4gICAgICAgICAgICBzZWFyY2hUZXh0LFxuICAgICAgICAgICAgY3VycmVudE1lbnRpb25zOiB0aGlzLm1lbnRpb25zLFxuICAgICAgICAgICAgbWF0Y2hpbmdNZW50aW9uczogdGhpcy5tZW50aW9ucy5maWx0ZXIobWVudGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgLy8gRW5zdXJlIHRoZSBtZW50aW9uIHN0YXJ0cyB3aXRoIHdoaXRlc3BhY2Ugb3IgaXMgYXQgdGhlIGJlZ2lubmluZyBvZiBhIGxpbmVcbiAgICAgICAgICAgICAgICBjb25zdCBjbGVhbk1lbnRpb24gPSBtZW50aW9uLnRleHQudHJpbSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjbGVhbk1lbnRpb24gPT09IHNlYXJjaFRleHQ7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWVudGlvbnMuZmlsdGVyKG1lbnRpb24gPT4ge1xuICAgICAgICAgICAgY29uc3QgY2xlYW5NZW50aW9uID0gbWVudGlvbi50ZXh0LnRyaW0oKTtcbiAgICAgICAgICAgIHJldHVybiBjbGVhbk1lbnRpb24gPT09IHNlYXJjaFRleHQ7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGFzeW5jIHNob3dNZW50aW9uUmVzdWx0cyhtZW50aW9uVGV4dDogc3RyaW5nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTaG93aW5nIG1lbnRpb24gcmVzdWx0cyBmb3I6JywgbWVudGlvblRleHQpO1xuICAgICAgICBjb25zdCByZXN1bHRzID0gdGhpcy5zZWFyY2hNZW50aW9ucyhtZW50aW9uVGV4dCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTZWFyY2ggcmVzdWx0czonLCByZXN1bHRzKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgbWVudGlvbnMgdmlldyB3aXRoIHNlYXJjaCByZXN1bHRzXG4gICAgICAgICAgICBpZiAodGhpcy5tZW50aW9uc1ZpZXcpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm1lbnRpb25zVmlldy5zZXRNZW50aW9ucyhyZXN1bHRzKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFjdGl2YXRlTWVudGlvbnNWaWV3KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBGb3VuZCAke3Jlc3VsdHMubGVuZ3RofSBtZW50aW9ucyBvZiAke21lbnRpb25UZXh0fWApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgTm8gbWVudGlvbnMgZm91bmQgZm9yICR7bWVudGlvblRleHR9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBhY3RpdmF0ZU1lbnRpb25zVmlldygpIHtcbiAgICAgICAgY29uc3QgeyB3b3Jrc3BhY2UgfSA9IHRoaXMuYXBwO1xuICAgICAgICBcbiAgICAgICAgbGV0IGxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9NRU5USU9OUylbMF07XG4gICAgICAgIFxuICAgICAgICBpZiAoIWxlYWYpIHtcbiAgICAgICAgICAgIGNvbnN0IHJpZ2h0TGVhZiA9IHdvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpO1xuICAgICAgICAgICAgaWYgKHJpZ2h0TGVhZikge1xuICAgICAgICAgICAgICAgIGxlYWYgPSByaWdodExlYWY7XG4gICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5zZXRWaWV3U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBWSUVXX1RZUEVfTUVOVElPTlMsXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeTogZmFsc2VcbiAgICAgICAgICAgICAgICB9IGFzIFZpZXdTdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobGVhZikge1xuICAgICAgICAgICAgd29ya3NwYWNlLnJldmVhbExlYWYobGVhZik7XG4gICAgICAgICAgICBpZiAodGhpcy5tZW50aW9uc1ZpZXcpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm1lbnRpb25zVmlldy5zZXRNZW50aW9ucyh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTWVudGlvbnNTZXR0aW5nVGFiKHRoaXMpKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdNZW50aW9uc1BsdWdpbiBsb2FkaW5nLi4uJyk7XG5cbiAgICAgICAgLy8gQWRkIENTU1xuICAgICAgICBjb25zdCBtZW50aW9uU3R5bGVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgbWVudGlvblN0eWxlcy50ZXh0Q29udGVudCA9IGBcbiAgICAgICAgICAgIC5tZW50aW9uLXRhZyB7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtYWNjZW50KTtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogMnB4IDRweDtcbiAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLm1lbnRpb24tdGFnOmhvdmVyIHtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAubWVudGlvbnMtbGlzdC1pdGVtIHtcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiA4cHg7XG4gICAgICAgICAgICAgICAgbWFyZ2luOiA0cHggMDtcbiAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLm1lbnRpb25zLWxpc3QtaXRlbTpob3ZlciB7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLm1lbnRpb24tZmlsZS1jb3VudCB7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC45ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgIGA7XG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQobWVudGlvblN0eWxlcyk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB2aWV3cyBhbmQgVUkgZmlyc3RcbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXcoXG4gICAgICAgICAgICBWSUVXX1RZUEVfTUVOVElPTlMsXG4gICAgICAgICAgICAobGVhZikgPT4gKHRoaXMubWVudGlvbnNWaWV3ID0gbmV3IE1lbnRpb25zVmlldyhsZWFmLCB0aGlzKSlcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLm1lbnRpb25TdWdnZXN0ID0gbmV3IE1lbnRpb25TdWdnZXN0KHRoaXMpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRWRpdG9yU3VnZ2VzdCh0aGlzLm1lbnRpb25TdWdnZXN0KTtcblxuICAgICAgICAvLyBSZWdpc3RlciBlZGl0b3IgZXh0ZW5zaW9uIGZvciBsaXZlIGhpZ2hsaWdodGluZ1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRWRpdG9yRXh0ZW5zaW9uKFtcbiAgICAgICAgICAgIHRoaXMuZGVjb3JhdGVNZW50aW9ucygpXG4gICAgICAgIF0pO1xuXG4gICAgICAgIHRoaXMuYWRkUmliYm9uSWNvbihcImF0LXNpZ25cIiwgXCJTaG93IFBlb3BsZSBtZW50aW9uc1wiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFjdGl2YXRlTWVudGlvbnNWaWV3KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJzaG93LW1lbnRpb25zLXZpZXdcIixcbiAgICAgICAgICAgIG5hbWU6IFwiU2hvdyBQZW9wbGUgbWVudGlvbnMgVmlld1wiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2YXRlTWVudGlvbnNWaWV3KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRoZW4gaGFuZGxlIG1lbnRpb25zIGRhdGFcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIExvYWQgc2F2ZWQgbWVudGlvbnNcbiAgICAgICAgICAgIGNvbnN0IHNhdmVkTWVudGlvbnMgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTG9hZGluZyBtZW50aW9ucyBmcm9tIHN0b3JhZ2U6Jywge1xuICAgICAgICAgICAgICAgIHNhdmVkTWVudGlvbnMsXG4gICAgICAgICAgICAgICAgaGFzRGF0YTogISFzYXZlZE1lbnRpb25zLFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiB0eXBlb2Ygc2F2ZWRNZW50aW9uc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzYXZlZE1lbnRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW50aW9ucyA9IHNhdmVkTWVudGlvbnM7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ01lbnRpb25zIGxvYWRlZCBpbnRvIG1lbW9yeTonLCB0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBMb2FkZWQgJHtzYXZlZE1lbnRpb25zLmxlbmd0aH0gbWVudGlvbnNgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUHJvY2VzcyBhbGwgZXhpc3RpbmcgbWFya2Rvd24gZmlsZXNcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQcm9jZXNzaW5nIGV4aXN0aW5nIGZpbGVzIGZvciBtZW50aW9ucy4uLicpO1xuICAgICAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gY29udGVudC5tYXRjaCgvKD86XnxcXHMpQFthLXpBLVpcdTA0MzAtXHUwNDRGXHUwNDEwLVx1MDQyRi4tXSsvZyk7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEZvdW5kIG1lbnRpb25zIGluICR7ZmlsZS5wYXRofTpgLCBtYXRjaGVzKTtcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcy5mb3JFYWNoKG1hdGNoID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuTWF0Y2ggPSBtYXRjaC50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGNvbnRlbnQuaW5kZXhPZihtYXRjaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGFkZCBpZiBub3QgYWxyZWFkeSBleGlzdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IHRoaXMubWVudGlvbnMuc29tZShtID0+IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0udGV4dCA9PT0gY2xlYW5NYXRjaCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmZpbGUgPT09IGZpbGUucGF0aCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnBvc2l0aW9uID09PSBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW50aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogY2xlYW5NYXRjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZTogZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm1lbnRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnSW5pdGlhbCBtZW50aW9ucyBmb3VuZDonLCB0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tZW50aW9uc1ZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5tZW50aW9uc1ZpZXcuc2V0TWVudGlvbnModGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJlZ2lzdGVyIHRoZSBtYXJrZG93biBwcm9jZXNzb3JcbiAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NvciA9IGFzeW5jIChlbDogSFRNTEVsZW1lbnQsIGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNYXJrZG93blBvc3RQcm9jZXNzb3IgY2FsbGVkIGZvcjonLCBjdHguc291cmNlUGF0aCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0VsZW1lbnQgY29udGVudDonLCBlbC5pbm5lckhUTUwpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IG1lbnRpb25zIGluIG1lbW9yeTonLCB0aGlzLm1lbnRpb25zKTtcblxuICAgICAgICAgICAgICAgIC8vIEZpcnN0LCBmaW5kIGFsbCBleGlzdGluZyBtZW50aW9uIGVsZW1lbnRzIGFuZCByZW1vdmUgdGhlbVxuICAgICAgICAgICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW50aW9uLXRhZycpLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlKCkpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29kZUJsb2NrcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2NvZGUnKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRm91bmQgY29kZSBibG9ja3M6JywgY29kZUJsb2Nrcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFNraXAgcHJvY2Vzc2luZyBjb2RlIGJsb2Nrc1xuICAgICAgICAgICAgICAgIGNvZGVCbG9ja3MuZm9yRWFjaChibG9jayA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLmFkZENsYXNzKCdtZW50aW9ucy1pZ25vcmUnKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIFByb2Nlc3MgdGV4dCBub2RlcyBmb3IgbWVudGlvbnNcbiAgICAgICAgICAgICAgICBjb25zdCB3YWxrZXIgPSBkb2N1bWVudC5jcmVhdGVUcmVlV2Fsa2VyKFxuICAgICAgICAgICAgICAgICAgICBlbCxcbiAgICAgICAgICAgICAgICAgICAgTm9kZUZpbHRlci5TSE9XX1RFWFQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdE5vZGU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0luQ29kZUJsb2NrID0gbm9kZS5wYXJlbnRFbGVtZW50Py5jbG9zZXN0KCcubWVudGlvbnMtaWdub3JlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNJbk1lbnRpb24gPSBub2RlLnBhcmVudEVsZW1lbnQ/Lmhhc0NsYXNzKCdtZW50aW9uLXRhZycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDaGVja2luZyBub2RlOicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbm9kZS50ZXh0Q29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNJbkNvZGVCbG9jayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNJbk1lbnRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudEVsZW1lbnQ6IG5vZGUucGFyZW50RWxlbWVudD8udGFnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NMaXN0OiBub2RlLnBhcmVudEVsZW1lbnQ/LmNsYXNzTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNraXAgbm9kZXMgdGhhdCBhcmUgY2hpbGRyZW4gb2YgY29kZSBibG9ja3Mgb3IgZXhpc3RpbmcgbWVudGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNJbkNvZGVCbG9jayB8fCBpc0luTWVudGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9kZUZpbHRlci5GSUxURVJfUkVKRUNUO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9kZUZpbHRlci5GSUxURVJfQUNDRVBUO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzVG9Qcm9jZXNzOiB7bm9kZTogVGV4dCwgbWF0Y2hlczogUmVnRXhwTWF0Y2hBcnJheX1bXSA9IFtdO1xuICAgICAgICAgICAgICAgIGxldCBub2RlOiBUZXh0IHwgbnVsbDtcbiAgICAgICAgICAgICAgICBsZXQgbm9kZUNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB3aGlsZSAobm9kZSA9IHdhbGtlci5uZXh0Tm9kZSgpIGFzIFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZUNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoUmVzdWx0ID0gbm9kZS50ZXh0Q29udGVudD8ubWF0Y2goLyg/Ol58XFxzKUBbYS16QS1aXHUwNDMwLVx1MDQ0Rlx1MDQxMC1cdTA0MkYuLV0rL2cpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBub2RlICR7bm9kZUNvdW50fTpgLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBub2RlLnRleHRDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hSZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaFJlc3VsdCAmJiBtYXRjaFJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1RvUHJvY2Vzcy5wdXNoKHtub2RlLCBtYXRjaGVzOiBtYXRjaFJlc3VsdH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEZvdW5kICR7bm9kZXNUb1Byb2Nlc3MubGVuZ3RofSBub2RlcyB3aXRoIG1lbnRpb25zYCk7XG5cbiAgICAgICAgICAgICAgICBub2Rlc1RvUHJvY2Vzcy5mb3JFYWNoKCh7bm9kZSwgbWF0Y2hlc30pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBvcyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0ZXh0ID0gbm9kZS50ZXh0Q29udGVudCB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcy5mb3JFYWNoKG1hdGNoID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0ZXh0IGJlZm9yZSB0aGUgbWVudGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmVmb3JlVGV4dCA9IHRleHQuc2xpY2UocG9zLCB0ZXh0LmluZGV4T2YobWF0Y2gsIHBvcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlZm9yZVRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmFnbWVudC5hcHBlbmQoYmVmb3JlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgbWVudGlvbiBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZW50aW9uRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZW50aW9uRWwuYWRkQ2xhc3MoJ21lbnRpb24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnRpb25FbC5hZGRDbGFzcygnbWVudGlvbi10YWcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnRpb25FbC50ZXh0Q29udGVudCA9IG1hdGNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVudGlvbkVsLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnRpb25FbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtbWVudGlvbicsIG1hdGNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgdGhlIG1lbnRpb24gYmVmb3JlIGFkZGluZyB0aGUgY2xpY2sgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0ZXh0LmluZGV4T2YobWF0Y2gsIHBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZW50aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1hdGNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGU6IGN0eC5zb3VyY2VQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT25seSBhZGQgaWYgbm90IGFscmVhZHkgZXhpc3RzXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdHMgPSB0aGlzLm1lbnRpb25zLnNvbWUobSA9PiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnRleHQgPT09IG1hdGNoICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uZmlsZSA9PT0gY3R4LnNvdXJjZVBhdGggJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5wb3NpdGlvbiA9PT0gcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0FkZGluZyBuZXcgbWVudGlvbjonLCBtZW50aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnRpb25zLnB1c2gobWVudGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlRGF0YSh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xpY2tIYW5kbGVyID0gYXN5bmMgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQ2xpY2sgaGFuZGxlciBjYWxsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTWVudGlvbiBjbGlja2VkOicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2gsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxUZXh0OiBtYXRjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoVGV4dDogbWF0Y2guc2xpY2UoMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNob3dNZW50aW9uUmVzdWx0cyhtYXRjaC5zbGljZSgxKSk7IC8vIFJlbW92ZSBAIHN5bWJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbWVudGlvbkVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xpY2tIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnRpb25FbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZChtZW50aW9uRWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gdGV4dC5pbmRleE9mKG1hdGNoLCBwb3MpICsgbWF0Y2gubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgYW55IHJlbWFpbmluZyB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3MgPCB0ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kKHRleHQuc2xpY2UocG9zKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBub2RlLnJlcGxhY2VXaXRoKGZyYWdtZW50KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgdmlldyBhbmQgc2F2ZSBkYXRhIGlmIG1lbnRpb25zIHdlcmUgZm91bmRcbiAgICAgICAgICAgICAgICBpZiAobm9kZXNUb1Byb2Nlc3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRm91bmQgbmV3IG1lbnRpb25zLCBjdXJyZW50IHN0YXRlOicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld01lbnRpb25zOiBub2Rlc1RvUHJvY2Vzcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbE1lbnRpb25zOiB0aGlzLm1lbnRpb25zLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnRpb25zRGF0YTogdGhpcy5tZW50aW9uc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1lbnRpb25zVmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW50aW9uc1ZpZXcuc2V0TWVudGlvbnModGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTYXZpbmcgbWVudGlvbnMgdG8gc3RvcmFnZS4uLicpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTWVudGlvbnMgc2F2ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gUmVnaXN0ZXIgZm9yIGJvdGggbm9ybWFsIHByZXZpZXcgYW5kIGxpdmUgcHJldmlld1xuICAgICAgICAgICAgdGhpcy5yZWdpc3Rlck1hcmtkb3duUG9zdFByb2Nlc3Nvcihwcm9jZXNzb3IpO1xuXG4gICAgICAgICAgICAvLyBSZWdpc3RlciBldmVudHMgZm9yIGZpbGUgbW9kaWZpY2F0aW9uc1xuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKFwibW9kaWZ5XCIsIGFzeW5jIChmaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGaWxlIG1vZGlmaWVkOicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCBmaWxlIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1Byb2Nlc3NpbmcgZmlsZSBjb250ZW50IGZvciBtZW50aW9ucycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgb2xkIG1lbnRpb25zIGZvciB0aGlzIGZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVudGlvbnMgPSB0aGlzLm1lbnRpb25zLmZpbHRlcihtID0+IG0uZmlsZSAhPT0gZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBhbGwgbWVudGlvbnMgaW4gdGhlIGZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBjb250ZW50Lm1hdGNoKC8oPzpefFxccylAW2EtekEtWlx1MDQzMC1cdTA0NEZcdTA0MTAtXHUwNDJGLi1dKy9nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZvdW5kIG1lbnRpb25zIGluIGZpbGU6JywgbWF0Y2hlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyBtZW50aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gY29udGVudC5pbmRleE9mKG1hdGNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW50aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1hdGNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZTogZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGVkIG1lbnRpb25zOicsIHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdmlldyBhbmQgc2F2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubWVudGlvbnNWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5tZW50aW9uc1ZpZXcuc2V0TWVudGlvbnModGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGZvciBmaWxlIGRlbGV0aW9uXG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQub24oXCJkZWxldGVcIiwgYXN5bmMgKGZpbGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUgZGVsZXRlZDonLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgYWxsIG1lbnRpb25zIGZyb20gdGhlIGRlbGV0ZWQgZmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmVmb3JlQ291bnQgPSB0aGlzLm1lbnRpb25zLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVudGlvbnMgPSB0aGlzLm1lbnRpb25zLmZpbHRlcihtID0+IG0uZmlsZSAhPT0gZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlbW92ZWRDb3VudCA9IGJlZm9yZUNvdW50IC0gdGhpcy5tZW50aW9ucy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdmVkQ291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFJlbW92ZWQgJHtyZW1vdmVkQ291bnR9IG1lbnRpb25zIGZyb20gZGVsZXRlZCBmaWxlOmAsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHZpZXcgYW5kIHNhdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tZW50aW9uc1ZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5tZW50aW9uc1ZpZXcuc2V0TWVudGlvbnModGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWxzbyByZWdpc3RlciBmb3IgZmlsZSBjcmVhdGlvblxuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKFwiY3JlYXRlXCIsIGFzeW5jIChmaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdOZXcgZmlsZSBjcmVhdGVkOicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBjb250ZW50Lm1hdGNoKC8oPzpefFxccylAW2EtekEtWlx1MDQzMC1cdTA0NEZcdTA0MTAtXHUwNDJGLi1dKy9nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcy5mb3JFYWNoKG1hdGNoID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBjb250ZW50LmluZGV4T2YobWF0Y2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbWF0Y2gsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdmlldyBhbmQgc2F2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1lbnRpb25zVmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm1lbnRpb25zVmlldy5zZXRNZW50aW9ucyh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBSZWdpc3RlciBmb3IgZmlsZSByZW5hbWVcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbihcInJlbmFtZVwiLCBhc3luYyAoZmlsZSwgb2xkUGF0aCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRmlsZSByZW5hbWVkOicsIHsgb2xkUGF0aCwgbmV3UGF0aDogZmlsZS5wYXRoIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZmlsZSBwYXRocyBpbiBtZW50aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW50aW9ucyA9IHRoaXMubWVudGlvbnMubWFwKG1lbnRpb24gPT4gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVudGlvbi5maWxlID09PSBvbGRQYXRoIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHsgLi4ubWVudGlvbiwgZmlsZTogZmlsZS5wYXRoIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBtZW50aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdmlldyBhbmQgc2F2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubWVudGlvbnNWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5tZW50aW9uc1ZpZXcuc2V0TWVudGlvbnModGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBjbGljayBoYW5kbGVyIGZvciBtZW50aW9uc1xuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZ0LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdtZW50aW9uLXRhZycpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lbnRpb25UZXh0ID0gdGFyZ2V0LnRleHRDb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBpZiAobWVudGlvblRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVuIHNlYXJjaCBwYW5lbCB3aXRoIHRoZSBtZW50aW9uIHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlYXJjaExlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdzZWFyY2gnKVswXSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaExlYWYuc2V0Vmlld1N0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VhcmNoJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZTogeyBxdWVyeTogbWVudGlvblRleHQgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKHNlYXJjaExlYWYpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNZW50aW9uc1BsdWdpbiBsb2FkZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgTWVudGlvbnNQbHVnaW4gaW5pdGlhbGl6YXRpb246JywgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnRXJyb3IgaW5pdGlhbGl6aW5nIE1lbnRpb25zIHBsdWdpbicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5kZXRhY2hMZWF2ZXNPZlR5cGUoVklFV19UWVBFX01FTlRJT05TKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGRlY29yYXRlTWVudGlvbnMoKSB7XG4gICAgICAgIHJldHVybiBTdGF0ZUZpZWxkLmRlZmluZTxEZWNvcmF0aW9uU2V0Pih7XG4gICAgICAgICAgICBjcmVhdGU6ICgpID0+IERlY29yYXRpb24ubm9uZSxcbiAgICAgICAgICAgIHVwZGF0ZTogKGRlY29yYXRpb25zLCB0cikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSB0ci5zdGF0ZS5kb2MudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gdGV4dC5tYXRjaCgvKD86XnxcXHMpQFthLXpBLVpcdTA0MzAtXHUwNDRGXHUwNDEwLVx1MDQyRi4tXSsvZyk7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVjb3JhdGlvbkFycmF5OiBhbnlbXSA9IFtdO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBvcyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXMuZm9yRWFjaCgobWF0Y2g6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xlYW5NYXRjaCA9IG1hdGNoLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gdGV4dC5pbmRleE9mKG1hdGNoLCBwb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIG1hdGNoLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZW50aW9uTWFyayA9IERlY29yYXRpb24ubWFyayh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcIm1lbnRpb24gbWVudGlvbi10YWdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogeyBcImRhdGEtbWVudGlvblwiOiBjbGVhbk1hdGNoIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNvcmF0aW9uQXJyYXkucHVzaChtZW50aW9uTWFyay5yYW5nZShzdGFydCwgZW5kKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gZW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gRGVjb3JhdGlvbi5zZXQoZGVjb3JhdGlvbkFycmF5LCB0cnVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcm92aWRlOiAoZmllbGQpID0+IEVkaXRvclZpZXcuZGVjb3JhdGlvbnMuZnJvbShmaWVsZClcbiAgICAgICAgfSk7XG4gICAgfVxufSAiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBcUJPO0FBRVAsa0JBQWtFO0FBQ2xFLG1CQUF3QztBQU14QyxJQUFNLG1CQUEyQztBQUFBLEVBQzdDLFdBQVc7QUFDZjtBQUVBLElBQU0sY0FBTixNQUFrQjtBQUFBLEVBR2QsWUFBWSxVQUFtQixPQUFPO0FBQ2xDLFNBQUssVUFBVTtBQUFBLEVBQ25CO0FBQUEsRUFFQSxXQUFXLFNBQWtCO0FBQ3pCLFNBQUssVUFBVTtBQUFBLEVBQ25CO0FBQUEsRUFFQSxPQUFPLE1BQWE7QUFDaEIsUUFBSSxLQUFLLFNBQVM7QUFDZCxjQUFRLElBQUkscUJBQXFCLEdBQUcsSUFBSTtBQUFBLElB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
