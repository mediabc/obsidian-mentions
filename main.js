/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MentionsPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
var DEFAULT_SETTINGS = {
  debugMode: false
};
var DebugLogger = class {
  constructor(enabled = false) {
    this.enabled = enabled;
  }
  setEnabled(enabled) {
    this.enabled = enabled;
  }
  log(...args) {
    if (this.enabled) {
      console.log("[Mentions Debug]:", ...args);
    }
  }
};
var MentionsSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(plugin) {
    super(plugin.app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Debug Mode").setDesc("Enable debug logging in the console").addToggle((toggle) => toggle.setValue(this.plugin.settings.debugMode).onChange(async (value) => {
      this.plugin.settings.debugMode = value;
      this.plugin.debugLogger.setEnabled(value);
      await this.plugin.saveSettings();
    }));
  }
};
var VIEW_TYPE_MENTIONS = "mentions-view";
var MentionSuggest = class extends import_obsidian.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.plugin = plugin;
  }
  onTrigger(cursor, editor, file) {
    const line = editor.getLine(cursor.line);
    const subString = line.substring(0, cursor.ch);
    const match = subString.match(/(?:^|\s)(@[a-zA-Zа-яА-Я.-]*)$/);
    this.plugin.debugLogger.log("MentionSuggest.onTrigger:", { line, subString, match });
    if (!match)
      return null;
    return {
      start: {
        line: cursor.line,
        ch: match.index + match[0].indexOf("@")
      },
      end: cursor,
      query: match[1].slice(1)
    };
  }
  getSuggestions(context) {
    const query = context.query.toLowerCase();
    const mentions = this.plugin.getMentions();
    this.plugin.debugLogger.log("Raw mentions from plugin:", mentions);
    const uniqueMentions = new Set(mentions.map((m) => m.text));
    this.plugin.debugLogger.log("Unique mentions:", Array.from(uniqueMentions));
    const suggestions = Array.from(uniqueMentions).filter((mention) => mention.toLowerCase().includes(query)).sort();
    this.plugin.debugLogger.log("MentionSuggest.getSuggestions:", {
      query,
      mentionsCount: mentions.length,
      suggestionsCount: suggestions.length,
      suggestions,
      uniqueMentionsCount: uniqueMentions.size
    });
    return suggestions;
  }
  renderSuggestion(value, el) {
    el.createEl("div", { text: value });
  }
  selectSuggestion(value) {
    const { context } = this;
    if (context) {
      const editor = context.editor;
      editor.replaceRange(
        value + " ",
        { line: context.start.line, ch: context.start.ch },
        context.end
      );
      const newCursorPos = {
        line: context.end.line,
        ch: context.start.ch + value.length + 1
      };
      editor.setCursor(newCursorPos);
    }
  }
};
var MentionsView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.mentions = [];
    this.plugin = plugin;
  }
  getViewType() {
    return VIEW_TYPE_MENTIONS;
  }
  getIcon() {
    return "at-sign";
  }
  getDisplayText() {
    return "People mentions";
  }
  async setMentions(mentions) {
    this.mentions = mentions;
    await this.refresh();
  }
  async refresh() {
    const container = this.containerEl.children[1];
    container.empty();
    const headerContainer = container.createEl("div", { cls: "mentions-header" });
    headerContainer.createEl("h2", { text: "People mentions", cls: "mentions-title" });
    const refreshButton = headerContainer.createEl("button", {
      cls: "mentions-refresh-button",
      text: "\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",
      attr: { "aria-label": "Refresh all mentions" }
    });
    refreshButton.addEventListener("click", async () => {
      refreshButton.addClass("refreshing");
      await this.plugin.refreshAllMentions();
      refreshButton.removeClass("refreshing");
    });
    const mentionGroups = /* @__PURE__ */ new Map();
    this.mentions.forEach((mention) => {
      const existingGroup = mentionGroups.get(mention.text) || [];
      mentionGroups.set(mention.text, [...existingGroup, mention]);
    });
    const mentionsList = container.createEl("ul", { cls: "mentions-list" });
    const sortedMentions = Array.from(mentionGroups.entries()).sort(([a], [b]) => a.localeCompare(b));
    sortedMentions.forEach(([mentionText, mentions]) => {
      const uniqueFiles = new Set(mentions.map((m) => m.file));
      const fileCount = uniqueFiles.size;
      const item = mentionsList.createEl("li", { cls: "mentions-list-item" });
      item.createEl("strong", { text: mentionText });
      item.createEl("br");
      item.createEl("span", {
        text: `Found in ${fileCount} file${fileCount !== 1 ? "s" : ""}`,
        cls: "mention-file-count"
      });
      item.addEventListener("click", () => {
        const searchLeaf = this.app.workspace.getLeavesOfType("search")[0] || this.app.workspace.getRightLeaf(false);
        searchLeaf.setViewState({
          type: "search",
          state: { query: mentionText }
        });
        this.app.workspace.revealLeaf(searchLeaf);
      });
    });
  }
};
var MentionsPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.mentions = [];
    this.editorDecorations = /* @__PURE__ */ new Map();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    this.debugLogger = new DebugLogger(this.settings.debugMode);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  getMentions() {
    this.debugLogger.log("Getting mentions:", this.mentions);
    return this.mentions;
  }
  async refreshAllMentions() {
    this.debugLogger.log("Starting full mentions refresh...");
    this.mentions = [];
    const files = this.app.vault.getMarkdownFiles();
    for (const file of files) {
      const content = await this.app.vault.read(file);
      const matches = content.match(/(?:^|\s)(@[a-zA-Zа-яА-Я.-]+)/g);
      if (matches) {
        matches.forEach((match) => {
          const cleanMatch = match.replace(/^\s*/, "");
          const position = content.indexOf(match);
          const exists = this.mentions.some(
            (m) => m.text === cleanMatch && m.file === file.path && m.position === position
          );
          if (!exists) {
            this.mentions.push({
              text: cleanMatch,
              file: file.path,
              position
            });
          }
        });
      }
    }
    this.debugLogger.log("Mentions refresh completed:", this.mentions);
    if (this.mentionsView) {
      await this.mentionsView.setMentions(this.mentions);
    }
    await this.saveData(this.mentions);
    new import_obsidian.Notice("Mentions refreshed successfully");
  }
  searchMentions(mentionText) {
    const searchText = mentionText.startsWith("@") ? mentionText : "@" + mentionText;
    console.log("Searching for mentions:", {
      searchText,
      currentMentions: this.mentions,
      matchingMentions: this.mentions.filter((mention) => {
        const cleanMention = mention.text.trim();
        return cleanMention === searchText;
      })
    });
    return this.mentions.filter((mention) => {
      const cleanMention = mention.text.trim();
      return cleanMention === searchText;
    });
  }
  async showMentionResults(mentionText) {
    console.log("Showing mention results for:", mentionText);
    const results = this.searchMentions(mentionText);
    console.log("Search results:", results);
    if (results.length > 0) {
      if (this.mentionsView) {
        await this.mentionsView.setMentions(results);
        await this.activateMentionsView();
      }
      new import_obsidian.Notice(`Found ${results.length} mentions of ${mentionText}`);
    } else {
      new import_obsidian.Notice(`No mentions found for ${mentionText}`);
    }
  }
  async activateMentionsView() {
    const { workspace } = this.app;
    let leaf = workspace.getLeavesOfType(VIEW_TYPE_MENTIONS)[0];
    if (!leaf) {
      const rightLeaf = workspace.getRightLeaf(false);
      if (rightLeaf) {
        leaf = rightLeaf;
        await leaf.setViewState({
          type: VIEW_TYPE_MENTIONS,
          active: true,
          history: false
        });
      }
    }
    if (leaf) {
      workspace.revealLeaf(leaf);
      if (this.mentionsView) {
        await this.mentionsView.setMentions(this.mentions);
      }
    }
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new MentionsSettingTab(this));
    console.log("MentionsPlugin loading...");
    const mentionStyles = document.createElement("style");
    mentionStyles.textContent = `
            .mention-tag {
                color: var(--text-accent);
                background-color: var(--background-modifier-border);
                padding: 0 4px;
                border-radius: 4px;
                cursor: pointer;
                display: inline-block;
                transition: background-color 0.2s ease;
                white-space: nowrap;
                line-height: normal;
            }
            .mention-tag:hover {
                background-color: var(--background-modifier-border-hover);
            }
            .mentions-list-item {
                padding: 8px;
                margin: 4px 0;
                border-radius: 4px;
                cursor: pointer;
                transition: background-color 0.2s ease;
            }
            .mentions-list-item:hover {
                background-color: var(--background-modifier-border);
            }
            .mention-file-count {
                color: var(--text-muted);
                font-size: 0.9em;
            }
        `;
    document.head.appendChild(mentionStyles);
    this.registerView(
      VIEW_TYPE_MENTIONS,
      (leaf) => this.mentionsView = new MentionsView(leaf, this)
    );
    this.mentionSuggest = new MentionSuggest(this);
    this.registerEditorSuggest(this.mentionSuggest);
    this.registerEditorExtension([
      this.decorateMentions()
    ]);
    this.addRibbonIcon("at-sign", "Show People mentions", () => {
      this.activateMentionsView();
    });
    this.addCommand({
      id: "show-mentions-view",
      name: "Show People mentions View",
      callback: () => {
        this.activateMentionsView();
      }
    });
    try {
      const savedMentions = await this.loadData();
      console.log("Loading mentions from storage:", {
        savedMentions,
        hasData: !!savedMentions,
        dataType: typeof savedMentions
      });
      if (savedMentions) {
        this.mentions = savedMentions;
        console.log("Mentions loaded into memory:", this.mentions);
        new import_obsidian.Notice(`Loaded ${savedMentions.length} mentions`);
      }
      console.log("Processing existing files for mentions...");
      const files = this.app.vault.getMarkdownFiles();
      for (const file of files) {
        const content = await this.app.vault.read(file);
        const matches = content.match(/(?:^|\s)(@[a-zA-Zа-яА-Я.-]+)/g);
        if (matches) {
          console.log(`Found mentions in ${file.path}:`, matches);
          matches.forEach((match) => {
            const cleanMatch = match.replace(/^\s*/, "");
            const position = content.indexOf(match);
            const exists = this.mentions.some(
              (m) => m.text === cleanMatch && m.file === file.path && m.position === position
            );
            if (!exists) {
              this.mentions.push({
                text: cleanMatch,
                file: file.path,
                position
              });
            }
          });
        }
      }
      if (this.mentions.length > 0) {
        console.log("Initial mentions found:", this.mentions);
        if (this.mentionsView) {
          await this.mentionsView.setMentions(this.mentions);
        }
        await this.saveData(this.mentions);
      }
      const processor = async (el, ctx) => {
        var _a;
        console.log("MarkdownPostProcessor called for:", ctx.sourcePath);
        console.log("Element content:", el.innerHTML);
        console.log("Current mentions in memory:", this.mentions);
        el.querySelectorAll(".mention-tag").forEach((el2) => el2.remove());
        const codeBlocks = el.querySelectorAll("code");
        console.log("Found code blocks:", codeBlocks.length);
        codeBlocks.forEach((block) => {
          block.addClass("mentions-ignore");
        });
        const walker = document.createTreeWalker(
          el,
          NodeFilter.SHOW_TEXT,
          {
            acceptNode: function(node2) {
              var _a2, _b, _c, _d;
              const isInCodeBlock = (_a2 = node2.parentElement) == null ? void 0 : _a2.closest(".mentions-ignore");
              const isInMention = (_b = node2.parentElement) == null ? void 0 : _b.hasClass("mention-tag");
              console.log("Checking node:", {
                text: node2.textContent,
                isInCodeBlock,
                isInMention,
                parentElement: (_c = node2.parentElement) == null ? void 0 : _c.tagName,
                classList: (_d = node2.parentElement) == null ? void 0 : _d.className
              });
              if (isInCodeBlock || isInMention) {
                return NodeFilter.FILTER_REJECT;
              }
              return NodeFilter.FILTER_ACCEPT;
            }
          }
        );
        const nodesToProcess = [];
        let node;
        let nodeCount = 0;
        while (node = walker.nextNode()) {
          nodeCount++;
          const matchResult = (_a = node.textContent) == null ? void 0 : _a.match(/(?:^|\s)(@[a-zA-Zа-яА-Я.-]+)/g);
          console.log(`Processing node ${nodeCount}:`, {
            text: node.textContent,
            matchResult
          });
          if (matchResult && matchResult.length > 0) {
            nodesToProcess.push({ node, matches: matchResult });
          }
        }
        console.log(`Found ${nodesToProcess.length} nodes with mentions`);
        nodesToProcess.forEach(({ node: node2, matches }) => {
          let pos = 0;
          let text = node2.textContent || "";
          const fragment = document.createDocumentFragment();
          matches.forEach((match) => {
            const cleanMatch = match.replace(/^\s*/, "");
            const beforeText = text.slice(pos, text.indexOf(match, pos));
            if (beforeText) {
              fragment.append(beforeText);
            }
            const mentionEl = document.createElement("span");
            mentionEl.addClass("mention");
            mentionEl.addClass("mention-tag");
            mentionEl.textContent = cleanMatch;
            mentionEl.style.cursor = "pointer";
            mentionEl.setAttribute("data-mention", cleanMatch);
            const position = text.indexOf(match, pos);
            const mention = {
              text: cleanMatch,
              file: ctx.sourcePath,
              position
            };
            const exists = this.mentions.some(
              (m) => m.text === cleanMatch && m.file === ctx.sourcePath && m.position === position
            );
            if (!exists) {
              console.log("Adding new mention:", mention);
              this.mentions.push(mention);
              this.saveData(this.mentions);
            }
            const clickHandler = async (e) => {
              console.log("Click handler called");
              e.preventDefault();
              e.stopPropagation();
              console.log("Mention clicked:", {
                match: cleanMatch,
                fullText: cleanMatch,
                searchText: cleanMatch.slice(1)
              });
              await this.showMentionResults(cleanMatch.slice(1));
            };
            mentionEl.removeEventListener("click", clickHandler);
            mentionEl.addEventListener("click", clickHandler);
            fragment.append(mentionEl);
            pos = text.indexOf(match, pos) + match.length;
          });
          if (pos < text.length) {
            fragment.append(text.slice(pos));
          }
          node2.replaceWith(fragment);
        });
        if (nodesToProcess.length > 0) {
          console.log("Found new mentions, current state:", {
            newMentions: nodesToProcess.length,
            totalMentions: this.mentions.length,
            mentionsData: this.mentions
          });
          if (this.mentionsView) {
            this.mentionsView.setMentions(this.mentions);
          }
          console.log("Saving mentions to storage...");
          await this.saveData(this.mentions);
          console.log("Mentions saved successfully");
        }
      };
      this.registerMarkdownPostProcessor(processor);
      this.registerEvent(
        this.app.vault.on("modify", async (file) => {
          if (file instanceof import_obsidian.TFile && file.extension === "md") {
            console.log("File modified:", file.path);
            const content = await this.app.vault.read(file);
            console.log("Processing file content for mentions");
            this.mentions = this.mentions.filter((m) => m.file !== file.path);
            const matches = content.match(/(?:^|\s)(@[a-zA-Zа-яА-Я.-]+)/g);
            if (matches) {
              console.log("Found mentions in file:", matches);
              matches.forEach((match) => {
                const cleanMatch = match.replace(/^\s*/, "");
                const position = content.indexOf(match);
                this.mentions.push({
                  text: cleanMatch,
                  file: file.path,
                  position
                });
              });
            }
            console.log("Updated mentions:", this.mentions);
            if (this.mentionsView) {
              await this.mentionsView.setMentions(this.mentions);
            }
            await this.saveData(this.mentions);
          }
        })
      );
      this.registerEvent(
        this.app.vault.on("delete", async (file) => {
          if (file instanceof import_obsidian.TFile && file.extension === "md") {
            console.log("File deleted:", file.path);
            const beforeCount = this.mentions.length;
            this.mentions = this.mentions.filter((m) => m.file !== file.path);
            const removedCount = beforeCount - this.mentions.length;
            if (removedCount > 0) {
              console.log(`Removed ${removedCount} mentions from deleted file:`, file.path);
              if (this.mentionsView) {
                await this.mentionsView.setMentions(this.mentions);
              }
              await this.saveData(this.mentions);
            }
          }
        })
      );
      this.registerEvent(
        this.app.vault.on("create", async (file) => {
          if (file instanceof import_obsidian.TFile && file.extension === "md") {
            console.log("New file created:", file.path);
            const content = await this.app.vault.read(file);
            const matches = content.match(/(?:^|\s)(@[a-zA-Zа-яА-Я.-]+)/g);
            if (matches) {
              matches.forEach((match) => {
                const cleanMatch = match.replace(/^\s*/, "");
                const position = content.indexOf(match);
                this.mentions.push({
                  text: cleanMatch,
                  file: file.path,
                  position
                });
              });
              if (this.mentionsView) {
                await this.mentionsView.setMentions(this.mentions);
              }
              await this.saveData(this.mentions);
            }
          }
        })
      );
      this.registerEvent(
        this.app.vault.on("rename", async (file, oldPath) => {
          if (file instanceof import_obsidian.TFile && file.extension === "md") {
            console.log("File renamed:", { oldPath, newPath: file.path });
            this.mentions = this.mentions.map(
              (mention) => mention.file === oldPath ? { ...mention, file: file.path } : mention
            );
            if (this.mentionsView) {
              await this.mentionsView.setMentions(this.mentions);
            }
            await this.saveData(this.mentions);
          }
        })
      );
      this.registerDomEvent(document, "click", (evt) => {
        const target = evt.target;
        if (target.hasClass("mention-tag")) {
          const mentionText = target.textContent;
          if (mentionText) {
            evt.preventDefault();
            evt.stopPropagation();
            const searchLeaf = this.app.workspace.getLeavesOfType("search")[0] || this.app.workspace.getRightLeaf(false);
            searchLeaf.setViewState({
              type: "search",
              state: { query: mentionText }
            });
            this.app.workspace.revealLeaf(searchLeaf);
          }
        }
      });
      console.log("MentionsPlugin loaded successfully");
    } catch (error) {
      console.error("Error during MentionsPlugin initialization:", error);
      new import_obsidian.Notice("Error initializing Mentions plugin");
    }
  }
  onunload() {
    this.app.workspace.detachLeavesOfType(VIEW_TYPE_MENTIONS);
  }
  decorateMentions() {
    return import_state.StateField.define({
      create: () => import_view.Decoration.none,
      update: (decorations, tr) => {
        const text = tr.state.doc.toString();
        const matches = text.match(/(?:^|\s)(@[a-zA-Zа-яА-Я.-]+)/g);
        const decorationArray = [];
        if (matches) {
          let pos = 0;
          matches.forEach((match) => {
            const fullMatch = match;
            const cleanMatch = match.replace(/^\s*/, "");
            const start = text.indexOf(fullMatch, pos) + (fullMatch.length - cleanMatch.length);
            if (start >= 0) {
              const end = start + cleanMatch.length;
              const mentionMark = import_view.Decoration.mark({
                class: "mention mention-tag",
                attributes: { "data-mention": cleanMatch }
              });
              decorationArray.push(mentionMark.range(start, end));
              pos = end;
            }
          });
        }
        return import_view.Decoration.set(decorationArray, true);
      },
      provide: (field) => import_view.EditorView.decorations.from(field)
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgXG4gICAgUGx1Z2luLCBcbiAgICBNYXJrZG93blZpZXcsIFxuICAgIE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsXG4gICAgVEZpbGUsXG4gICAgV29ya3NwYWNlTGVhZixcbiAgICBJdGVtVmlldyxcbiAgICBWaWV3U3RhdGUsXG4gICAgRWRpdG9yU3VnZ2VzdCxcbiAgICBFZGl0b3JQb3NpdGlvbixcbiAgICBFZGl0b3IsXG4gICAgVEFic3RyYWN0RmlsZSxcbiAgICBFZGl0b3JTdWdnZXN0Q29udGV4dCxcbiAgICBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8sXG4gICAgTm90aWNlLFxuICAgIEljb25OYW1lLFxuICAgIEVkaXRvclRyYW5zYWN0aW9uLFxuICAgIE1hcmtkb3duRmlsZUluZm8sXG4gICAgZWRpdG9yVmlld0ZpZWxkLFxuICAgIFBsdWdpblNldHRpbmdUYWIsXG4gICAgU2V0dGluZ1xufSBmcm9tICdvYnNpZGlhbic7XG5cbmltcG9ydCB7IEVkaXRvclZpZXcsIERlY29yYXRpb24sIERlY29yYXRpb25TZXQsIFZpZXdVcGRhdGUgfSBmcm9tICdAY29kZW1pcnJvci92aWV3JztcbmltcG9ydCB7IFN0YXRlRmllbGQsIFN0YXRlRWZmZWN0IH0gZnJvbSAnQGNvZGVtaXJyb3Ivc3RhdGUnO1xuXG5pbnRlcmZhY2UgTWVudGlvbnNQbHVnaW5TZXR0aW5ncyB7XG4gICAgZGVidWdNb2RlOiBib29sZWFuO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBNZW50aW9uc1BsdWdpblNldHRpbmdzID0ge1xuICAgIGRlYnVnTW9kZTogZmFsc2Vcbn07XG5cbmNsYXNzIERlYnVnTG9nZ2VyIHtcbiAgICBwcml2YXRlIGVuYWJsZWQ6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihlbmFibGVkOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5lbmFibGVkID0gZW5hYmxlZDtcbiAgICB9XG5cbiAgICBzZXRFbmFibGVkKGVuYWJsZWQ6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5lbmFibGVkID0gZW5hYmxlZDtcbiAgICB9XG5cbiAgICBsb2coLi4uYXJnczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNZW50aW9ucyBEZWJ1Z106JywgLi4uYXJncyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIE1lbnRpb25zU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogTWVudGlvbnNQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1lbnRpb25zUGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGVidWcgTW9kZScpXG4gICAgICAgICAgICAuc2V0RGVzYygnRW5hYmxlIGRlYnVnIGxvZ2dpbmcgaW4gdGhlIGNvbnNvbGUnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kZWJ1Z0xvZ2dlci5zZXRFbmFibGVkKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuaW50ZXJmYWNlIE1lbnRpb24ge1xuICAgIHRleHQ6IHN0cmluZztcbiAgICBmaWxlOiBzdHJpbmc7XG4gICAgcG9zaXRpb246IG51bWJlcjtcbn1cblxuY29uc3QgVklFV19UWVBFX01FTlRJT05TID0gXCJtZW50aW9ucy12aWV3XCI7XG5cbmNsYXNzIE1lbnRpb25TdWdnZXN0IGV4dGVuZHMgRWRpdG9yU3VnZ2VzdDxzdHJpbmc+IHtcbiAgICBwbHVnaW46IE1lbnRpb25zUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZW50aW9uc1BsdWdpbikge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgb25UcmlnZ2VyKGN1cnNvcjogRWRpdG9yUG9zaXRpb24sIGVkaXRvcjogRWRpdG9yLCBmaWxlOiBURmlsZSB8IG51bGwpOiBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8gfCBudWxsIHtcbiAgICAgICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcbiAgICAgICAgY29uc3Qgc3ViU3RyaW5nID0gbGluZS5zdWJzdHJpbmcoMCwgY3Vyc29yLmNoKTtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBzdWJTdHJpbmcubWF0Y2goLyg/Ol58XFxzKShAW2EtekEtWlx1MDQzMC1cdTA0NEZcdTA0MTAtXHUwNDJGLi1dKikkLyk7XG5cbiAgICAgICAgdGhpcy5wbHVnaW4uZGVidWdMb2dnZXIubG9nKCdNZW50aW9uU3VnZ2VzdC5vblRyaWdnZXI6JywgeyBsaW5lLCBzdWJTdHJpbmcsIG1hdGNoIH0pO1xuXG4gICAgICAgIGlmICghbWF0Y2gpIHJldHVybiBudWxsO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydDoge1xuICAgICAgICAgICAgICAgIGxpbmU6IGN1cnNvci5saW5lLFxuICAgICAgICAgICAgICAgIGNoOiBtYXRjaC5pbmRleCEgKyBtYXRjaFswXS5pbmRleE9mKCdAJyksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW5kOiBjdXJzb3IsXG4gICAgICAgICAgICBxdWVyeTogbWF0Y2hbMV0uc2xpY2UoMSksXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMoY29udGV4dDogRWRpdG9yU3VnZ2VzdENvbnRleHQpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gY29udGV4dC5xdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBtZW50aW9ucyA9IHRoaXMucGx1Z2luLmdldE1lbnRpb25zKCk7XG4gICAgICAgIHRoaXMucGx1Z2luLmRlYnVnTG9nZ2VyLmxvZygnUmF3IG1lbnRpb25zIGZyb20gcGx1Z2luOicsIG1lbnRpb25zKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHVuaXF1ZU1lbnRpb25zID0gbmV3IFNldChtZW50aW9ucy5tYXAobSA9PiBtLnRleHQpKTtcbiAgICAgICAgdGhpcy5wbHVnaW4uZGVidWdMb2dnZXIubG9nKCdVbmlxdWUgbWVudGlvbnM6JywgQXJyYXkuZnJvbSh1bmlxdWVNZW50aW9ucykpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBBcnJheS5mcm9tKHVuaXF1ZU1lbnRpb25zKVxuICAgICAgICAgICAgLmZpbHRlcihtZW50aW9uID0+IG1lbnRpb24udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkpXG4gICAgICAgICAgICAuc29ydCgpO1xuXG4gICAgICAgIHRoaXMucGx1Z2luLmRlYnVnTG9nZ2VyLmxvZygnTWVudGlvblN1Z2dlc3QuZ2V0U3VnZ2VzdGlvbnM6JywgeyBcbiAgICAgICAgICAgIHF1ZXJ5LCBcbiAgICAgICAgICAgIG1lbnRpb25zQ291bnQ6IG1lbnRpb25zLmxlbmd0aCxcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zQ291bnQ6IHN1Z2dlc3Rpb25zLmxlbmd0aCxcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLFxuICAgICAgICAgICAgdW5pcXVlTWVudGlvbnNDb3VudDogdW5pcXVlTWVudGlvbnMuc2l6ZVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiB2YWx1ZSB9KTtcbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0IH0gPSB0aGlzO1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gY29udGV4dC5lZGl0b3I7XG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKFxuICAgICAgICAgICAgICAgIHZhbHVlICsgJyAnLFxuICAgICAgICAgICAgICAgIHsgbGluZTogY29udGV4dC5zdGFydC5saW5lLCBjaDogY29udGV4dC5zdGFydC5jaCB9LFxuICAgICAgICAgICAgICAgIGNvbnRleHQuZW5kXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBuZXdDdXJzb3JQb3MgPSB7XG4gICAgICAgICAgICAgICAgbGluZTogY29udGV4dC5lbmQubGluZSxcbiAgICAgICAgICAgICAgICBjaDogY29udGV4dC5zdGFydC5jaCArIHZhbHVlLmxlbmd0aCArIDFcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKG5ld0N1cnNvclBvcyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIE1lbnRpb25zVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcbiAgICBtZW50aW9uczogTWVudGlvbltdID0gW107XG4gICAgcGx1Z2luOiBNZW50aW9uc1BsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogTWVudGlvbnNQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIobGVhZik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGdldFZpZXdUeXBlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBWSUVXX1RZUEVfTUVOVElPTlM7XG4gICAgfVxuXG4gICAgZ2V0SWNvbigpOiBJY29uTmFtZSB7XG4gICAgICAgIHJldHVybiBcImF0LXNpZ25cIjtcbiAgICB9XG4gICAgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIFwiUGVvcGxlIG1lbnRpb25zXCI7XG4gICAgfVxuXG4gICAgYXN5bmMgc2V0TWVudGlvbnMobWVudGlvbnM6IE1lbnRpb25bXSkge1xuICAgICAgICB0aGlzLm1lbnRpb25zID0gbWVudGlvbnM7XG4gICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaCgpO1xuICAgIH1cblxuICAgIGFzeW5jIHJlZnJlc2goKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV07XG4gICAgICAgIGNvbnRhaW5lci5lbXB0eSgpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBoZWFkZXIgY29udGFpbmVyIHdpdGggdGl0bGUgYW5kIHJlZnJlc2ggYnV0dG9uXG4gICAgICAgIGNvbnN0IGhlYWRlckNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZW50aW9ucy1oZWFkZXJcIiB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCB0aXRsZVxuICAgICAgICBoZWFkZXJDb250YWluZXIuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiUGVvcGxlIG1lbnRpb25zXCIsIGNsczogXCJtZW50aW9ucy10aXRsZVwiIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHJlZnJlc2ggYnV0dG9uIHdpdGggdGV4dCBpbnN0ZWFkIG9mIGljb25cbiAgICAgICAgY29uc3QgcmVmcmVzaEJ1dHRvbiA9IGhlYWRlckNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7IFxuICAgICAgICAgICAgY2xzOiBcIm1lbnRpb25zLXJlZnJlc2gtYnV0dG9uXCIsXG4gICAgICAgICAgICB0ZXh0OiBcIlx1MDQxRVx1MDQzMVx1MDQzRFx1MDQzRVx1MDQzMlx1MDQzOFx1MDQ0Mlx1MDQ0Q1wiLFxuICAgICAgICAgICAgYXR0cjogeyAnYXJpYS1sYWJlbCc6ICdSZWZyZXNoIGFsbCBtZW50aW9ucycgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHJlZnJlc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHJlZnJlc2hCdXR0b24uYWRkQ2xhc3MoXCJyZWZyZXNoaW5nXCIpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4ucmVmcmVzaEFsbE1lbnRpb25zKCk7XG4gICAgICAgICAgICByZWZyZXNoQnV0dG9uLnJlbW92ZUNsYXNzKFwicmVmcmVzaGluZ1wiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gR3JvdXAgbWVudGlvbnMgYnkgdGV4dFxuICAgICAgICBjb25zdCBtZW50aW9uR3JvdXBzID0gbmV3IE1hcDxzdHJpbmcsIE1lbnRpb25bXT4oKTtcbiAgICAgICAgdGhpcy5tZW50aW9ucy5mb3JFYWNoKG1lbnRpb24gPT4ge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdHcm91cCA9IG1lbnRpb25Hcm91cHMuZ2V0KG1lbnRpb24udGV4dCkgfHwgW107XG4gICAgICAgICAgICBtZW50aW9uR3JvdXBzLnNldChtZW50aW9uLnRleHQsIFsuLi5leGlzdGluZ0dyb3VwLCBtZW50aW9uXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG1lbnRpb25zTGlzdCA9IGNvbnRhaW5lci5jcmVhdGVFbChcInVsXCIsIHsgY2xzOiBcIm1lbnRpb25zLWxpc3RcIiB9KTtcblxuICAgICAgICAvLyBTb3J0IG1lbnRpb25zIGFscGhhYmV0aWNhbGx5XG4gICAgICAgIGNvbnN0IHNvcnRlZE1lbnRpb25zID0gQXJyYXkuZnJvbShtZW50aW9uR3JvdXBzLmVudHJpZXMoKSkuc29ydCgoW2FdLCBbYl0pID0+IGEubG9jYWxlQ29tcGFyZShiKSk7XG5cbiAgICAgICAgc29ydGVkTWVudGlvbnMuZm9yRWFjaCgoW21lbnRpb25UZXh0LCBtZW50aW9uc10pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHVuaXF1ZUZpbGVzID0gbmV3IFNldChtZW50aW9ucy5tYXAobSA9PiBtLmZpbGUpKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDb3VudCA9IHVuaXF1ZUZpbGVzLnNpemU7XG5cbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBtZW50aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7IGNsczogXCJtZW50aW9ucy1saXN0LWl0ZW1cIiB9KTtcbiAgICAgICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJzdHJvbmdcIiwgeyB0ZXh0OiBtZW50aW9uVGV4dCB9KTtcbiAgICAgICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJiclwiKTtcbiAgICAgICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJzcGFuXCIsIHsgXG4gICAgICAgICAgICAgICAgdGV4dDogYEZvdW5kIGluICR7ZmlsZUNvdW50fSBmaWxlJHtmaWxlQ291bnQgIT09IDEgPyAncycgOiAnJ31gLFxuICAgICAgICAgICAgICAgIGNsczogXCJtZW50aW9uLWZpbGUtY291bnRcIiBcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gT3BlbiBzZWFyY2ggcGFuZWwgd2l0aCB0aGUgbWVudGlvbiB0ZXh0XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VhcmNoTGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ3NlYXJjaCcpWzBdIHx8IFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc2VhcmNoTGVhZi5zZXRWaWV3U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VhcmNoJyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGU6IHsgcXVlcnk6IG1lbnRpb25UZXh0IH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihzZWFyY2hMZWFmKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lbnRpb25zUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBwcml2YXRlIG1lbnRpb25zVmlldzogTWVudGlvbnNWaWV3O1xuICAgIHByaXZhdGUgbWVudGlvbnM6IE1lbnRpb25bXSA9IFtdO1xuICAgIHByaXZhdGUgbWVudGlvblN1Z2dlc3Q6IE1lbnRpb25TdWdnZXN0O1xuICAgIHByaXZhdGUgZWRpdG9yRGVjb3JhdGlvbnM6IE1hcDxzdHJpbmcsIERlY29yYXRpb25TZXQ+ID0gbmV3IE1hcCgpO1xuICAgIHNldHRpbmdzOiBNZW50aW9uc1BsdWdpblNldHRpbmdzO1xuICAgIGRlYnVnTG9nZ2VyOiBEZWJ1Z0xvZ2dlcjtcblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgICAgIHRoaXMuZGVidWdMb2dnZXIgPSBuZXcgRGVidWdMb2dnZXIodGhpcy5zZXR0aW5ncy5kZWJ1Z01vZGUpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBnZXRNZW50aW9ucygpOiBNZW50aW9uW10ge1xuICAgICAgICB0aGlzLmRlYnVnTG9nZ2VyLmxvZygnR2V0dGluZyBtZW50aW9uczonLCB0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWVudGlvbnM7XG4gICAgfVxuXG4gICAgYXN5bmMgcmVmcmVzaEFsbE1lbnRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmRlYnVnTG9nZ2VyLmxvZygnU3RhcnRpbmcgZnVsbCBtZW50aW9ucyByZWZyZXNoLi4uJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhciBleGlzdGluZyBtZW50aW9uc1xuICAgICAgICB0aGlzLm1lbnRpb25zID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBQcm9jZXNzIGFsbCBtYXJrZG93biBmaWxlc1xuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBjb250ZW50Lm1hdGNoKC8oPzpefFxccykoQFthLXpBLVpcdTA0MzAtXHUwNDRGXHUwNDEwLVx1MDQyRi4tXSspL2cpO1xuICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICBtYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGVhbk1hdGNoID0gbWF0Y2gucmVwbGFjZSgvXlxccyovLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gY29udGVudC5pbmRleE9mKG1hdGNoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gT25seSBhZGQgaWYgbm90IGFscmVhZHkgZXhpc3RzXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IHRoaXMubWVudGlvbnMuc29tZShtID0+IFxuICAgICAgICAgICAgICAgICAgICAgICAgbS50ZXh0ID09PSBjbGVhbk1hdGNoICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgbS5maWxlID09PSBmaWxlLnBhdGggJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICBtLnBvc2l0aW9uID09PSBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW50aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBjbGVhbk1hdGNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZGVidWdMb2dnZXIubG9nKCdNZW50aW9ucyByZWZyZXNoIGNvbXBsZXRlZDonLCB0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSB2aWV3IGFuZCBzYXZlIGRhdGFcbiAgICAgICAgaWYgKHRoaXMubWVudGlvbnNWaWV3KSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLm1lbnRpb25zVmlldy5zZXRNZW50aW9ucyh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMubWVudGlvbnMpO1xuICAgICAgICBcbiAgICAgICAgbmV3IE5vdGljZSgnTWVudGlvbnMgcmVmcmVzaGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIH1cblxuICAgIHNlYXJjaE1lbnRpb25zKG1lbnRpb25UZXh0OiBzdHJpbmcpOiBNZW50aW9uW10ge1xuICAgICAgICAvLyBSZW1vdmUgQCBzeW1ib2wgaWYgcHJlc2VudFxuICAgICAgICBjb25zdCBzZWFyY2hUZXh0ID0gbWVudGlvblRleHQuc3RhcnRzV2l0aCgnQCcpID8gbWVudGlvblRleHQgOiAnQCcgKyBtZW50aW9uVGV4dDtcbiAgICAgICAgY29uc29sZS5sb2coJ1NlYXJjaGluZyBmb3IgbWVudGlvbnM6Jywge1xuICAgICAgICAgICAgc2VhcmNoVGV4dCxcbiAgICAgICAgICAgIGN1cnJlbnRNZW50aW9uczogdGhpcy5tZW50aW9ucyxcbiAgICAgICAgICAgIG1hdGNoaW5nTWVudGlvbnM6IHRoaXMubWVudGlvbnMuZmlsdGVyKG1lbnRpb24gPT4ge1xuICAgICAgICAgICAgICAgIC8vIEVuc3VyZSB0aGUgbWVudGlvbiBzdGFydHMgd2l0aCB3aGl0ZXNwYWNlIG9yIGlzIGF0IHRoZSBiZWdpbm5pbmcgb2YgYSBsaW5lXG4gICAgICAgICAgICAgICAgY29uc3QgY2xlYW5NZW50aW9uID0gbWVudGlvbi50ZXh0LnRyaW0oKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2xlYW5NZW50aW9uID09PSBzZWFyY2hUZXh0O1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLm1lbnRpb25zLmZpbHRlcihtZW50aW9uID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuTWVudGlvbiA9IG1lbnRpb24udGV4dC50cmltKCk7XG4gICAgICAgICAgICByZXR1cm4gY2xlYW5NZW50aW9uID09PSBzZWFyY2hUZXh0O1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyBzaG93TWVudGlvblJlc3VsdHMobWVudGlvblRleHQ6IHN0cmluZykge1xuICAgICAgICBjb25zb2xlLmxvZygnU2hvd2luZyBtZW50aW9uIHJlc3VsdHMgZm9yOicsIG1lbnRpb25UZXh0KTtcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHRoaXMuc2VhcmNoTWVudGlvbnMobWVudGlvblRleHQpO1xuICAgICAgICBjb25zb2xlLmxvZygnU2VhcmNoIHJlc3VsdHM6JywgcmVzdWx0cyk7XG4gICAgICAgIFxuICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIG1lbnRpb25zIHZpZXcgd2l0aCBzZWFyY2ggcmVzdWx0c1xuICAgICAgICAgICAgaWYgKHRoaXMubWVudGlvbnNWaWV3KSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5tZW50aW9uc1ZpZXcuc2V0TWVudGlvbnMocmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hY3RpdmF0ZU1lbnRpb25zVmlldygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3IE5vdGljZShgRm91bmQgJHtyZXN1bHRzLmxlbmd0aH0gbWVudGlvbnMgb2YgJHttZW50aW9uVGV4dH1gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYE5vIG1lbnRpb25zIGZvdW5kIGZvciAke21lbnRpb25UZXh0fWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgYWN0aXZhdGVNZW50aW9uc1ZpZXcoKSB7XG4gICAgICAgIGNvbnN0IHsgd29ya3NwYWNlIH0gPSB0aGlzLmFwcDtcbiAgICAgICAgXG4gICAgICAgIGxldCBsZWFmID0gd29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTUVOVElPTlMpWzBdO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFsZWFmKSB7XG4gICAgICAgICAgICBjb25zdCByaWdodExlYWYgPSB3b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKTtcbiAgICAgICAgICAgIGlmIChyaWdodExlYWYpIHtcbiAgICAgICAgICAgICAgICBsZWFmID0gcmlnaHRMZWFmO1xuICAgICAgICAgICAgICAgIGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogVklFV19UWVBFX01FTlRJT05TLFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGhpc3Rvcnk6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSBhcyBWaWV3U3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxlYWYpIHtcbiAgICAgICAgICAgIHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuICAgICAgICAgICAgaWYgKHRoaXMubWVudGlvbnNWaWV3KSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5tZW50aW9uc1ZpZXcuc2V0TWVudGlvbnModGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IE1lbnRpb25zU2V0dGluZ1RhYih0aGlzKSk7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnTWVudGlvbnNQbHVnaW4gbG9hZGluZy4uLicpO1xuXG4gICAgICAgIC8vIEFkZCBDU1NcbiAgICAgICAgY29uc3QgbWVudGlvblN0eWxlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICAgIG1lbnRpb25TdHlsZXMudGV4dENvbnRlbnQgPSBgXG4gICAgICAgICAgICAubWVudGlvbi10YWcge1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LWFjY2VudCk7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAgNHB4O1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuICAgICAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gICAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5tZW50aW9uLXRhZzpob3ZlciB7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLm1lbnRpb25zLWxpc3QtaXRlbSB7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgICAgICAgICAgIG1hcmdpbjogNHB4IDA7XG4gICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5tZW50aW9ucy1saXN0LWl0ZW06aG92ZXIge1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5tZW50aW9uLWZpbGUtY291bnQge1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuOWVtO1xuICAgICAgICAgICAgfVxuICAgICAgICBgO1xuICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKG1lbnRpb25TdHlsZXMpO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgdmlld3MgYW5kIFVJIGZpcnN0XG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3KFxuICAgICAgICAgICAgVklFV19UWVBFX01FTlRJT05TLFxuICAgICAgICAgICAgKGxlYWYpID0+ICh0aGlzLm1lbnRpb25zVmlldyA9IG5ldyBNZW50aW9uc1ZpZXcobGVhZiwgdGhpcykpXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5tZW50aW9uU3VnZ2VzdCA9IG5ldyBNZW50aW9uU3VnZ2VzdCh0aGlzKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlckVkaXRvclN1Z2dlc3QodGhpcy5tZW50aW9uU3VnZ2VzdCk7XG5cbiAgICAgICAgLy8gUmVnaXN0ZXIgZWRpdG9yIGV4dGVuc2lvbiBmb3IgbGl2ZSBoaWdobGlnaHRpbmdcbiAgICAgICAgdGhpcy5yZWdpc3RlckVkaXRvckV4dGVuc2lvbihbXG4gICAgICAgICAgICB0aGlzLmRlY29yYXRlTWVudGlvbnMoKVxuICAgICAgICBdKTtcblxuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oXCJhdC1zaWduXCIsIFwiU2hvdyBQZW9wbGUgbWVudGlvbnNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hY3RpdmF0ZU1lbnRpb25zVmlldygpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwic2hvdy1tZW50aW9ucy12aWV3XCIsXG4gICAgICAgICAgICBuYW1lOiBcIlNob3cgUGVvcGxlIG1lbnRpb25zIFZpZXdcIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmF0ZU1lbnRpb25zVmlldygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUaGVuIGhhbmRsZSBtZW50aW9ucyBkYXRhXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBMb2FkIHNhdmVkIG1lbnRpb25zXG4gICAgICAgICAgICBjb25zdCBzYXZlZE1lbnRpb25zID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvYWRpbmcgbWVudGlvbnMgZnJvbSBzdG9yYWdlOicsIHtcbiAgICAgICAgICAgICAgICBzYXZlZE1lbnRpb25zLFxuICAgICAgICAgICAgICAgIGhhc0RhdGE6ICEhc2F2ZWRNZW50aW9ucyxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogdHlwZW9mIHNhdmVkTWVudGlvbnNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoc2F2ZWRNZW50aW9ucykge1xuICAgICAgICAgICAgICAgIHRoaXMubWVudGlvbnMgPSBzYXZlZE1lbnRpb25zO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNZW50aW9ucyBsb2FkZWQgaW50byBtZW1vcnk6JywgdGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTG9hZGVkICR7c2F2ZWRNZW50aW9ucy5sZW5ndGh9IG1lbnRpb25zYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFByb2Nlc3MgYWxsIGV4aXN0aW5nIG1hcmtkb3duIGZpbGVzXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUHJvY2Vzc2luZyBleGlzdGluZyBmaWxlcyBmb3IgbWVudGlvbnMuLi4nKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGNvbnRlbnQubWF0Y2goLyg/Ol58XFxzKShAW2EtekEtWlx1MDQzMC1cdTA0NEZcdTA0MTAtXHUwNDJGLi1dKykvZyk7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEZvdW5kIG1lbnRpb25zIGluICR7ZmlsZS5wYXRofTpgLCBtYXRjaGVzKTtcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcy5mb3JFYWNoKG1hdGNoID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuTWF0Y2ggPSBtYXRjaC5yZXBsYWNlKC9eXFxzKi8sICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gY29udGVudC5pbmRleE9mKG1hdGNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgYWRkIGlmIG5vdCBhbHJlYWR5IGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RzID0gdGhpcy5tZW50aW9ucy5zb21lKG0gPT4gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbS50ZXh0ID09PSBjbGVhbk1hdGNoICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uZmlsZSA9PT0gZmlsZS5wYXRoICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0ucG9zaXRpb24gPT09IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBjbGVhbk1hdGNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMubWVudGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdJbml0aWFsIG1lbnRpb25zIGZvdW5kOicsIHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1lbnRpb25zVmlldykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm1lbnRpb25zVmlldy5zZXRNZW50aW9ucyh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIG1hcmtkb3duIHByb2Nlc3NvclxuICAgICAgICAgICAgY29uc3QgcHJvY2Vzc29yID0gYXN5bmMgKGVsOiBIVE1MRWxlbWVudCwgY3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ01hcmtkb3duUG9zdFByb2Nlc3NvciBjYWxsZWQgZm9yOicsIGN0eC5zb3VyY2VQYXRoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRWxlbWVudCBjb250ZW50OicsIGVsLmlubmVySFRNTCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0N1cnJlbnQgbWVudGlvbnMgaW4gbWVtb3J5OicsIHRoaXMubWVudGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgLy8gRmlyc3QsIGZpbmQgYWxsIGV4aXN0aW5nIG1lbnRpb24gZWxlbWVudHMgYW5kIHJlbW92ZSB0aGVtXG4gICAgICAgICAgICAgICAgZWwucXVlcnlTZWxlY3RvckFsbCgnLm1lbnRpb24tdGFnJykuZm9yRWFjaChlbCA9PiBlbC5yZW1vdmUoKSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlQmxvY2tzID0gZWwucXVlcnlTZWxlY3RvckFsbCgnY29kZScpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCBjb2RlIGJsb2NrczonLCBjb2RlQmxvY2tzLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gU2tpcCBwcm9jZXNzaW5nIGNvZGUgYmxvY2tzXG4gICAgICAgICAgICAgICAgY29kZUJsb2Nrcy5mb3JFYWNoKGJsb2NrID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suYWRkQ2xhc3MoJ21lbnRpb25zLWlnbm9yZScpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gUHJvY2VzcyB0ZXh0IG5vZGVzIGZvciBtZW50aW9uc1xuICAgICAgICAgICAgICAgIGNvbnN0IHdhbGtlciA9IGRvY3VtZW50LmNyZWF0ZVRyZWVXYWxrZXIoXG4gICAgICAgICAgICAgICAgICAgIGVsLFxuICAgICAgICAgICAgICAgICAgICBOb2RlRmlsdGVyLlNIT1dfVEVYVCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0Tm9kZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzSW5Db2RlQmxvY2sgPSBub2RlLnBhcmVudEVsZW1lbnQ/LmNsb3Nlc3QoJy5tZW50aW9ucy1pZ25vcmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0luTWVudGlvbiA9IG5vZGUucGFyZW50RWxlbWVudD8uaGFzQ2xhc3MoJ21lbnRpb24tdGFnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0NoZWNraW5nIG5vZGU6Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBub2RlLnRleHRDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0luQ29kZUJsb2NrLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0luTWVudGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50RWxlbWVudDogbm9kZS5wYXJlbnRFbGVtZW50Py50YWdOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc0xpc3Q6IG5vZGUucGFyZW50RWxlbWVudD8uY2xhc3NOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCBub2RlcyB0aGF0IGFyZSBjaGlsZHJlbiBvZiBjb2RlIGJsb2NrcyBvciBleGlzdGluZyBtZW50aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0luQ29kZUJsb2NrIHx8IGlzSW5NZW50aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBOb2RlRmlsdGVyLkZJTFRFUl9SRUpFQ1Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBOb2RlRmlsdGVyLkZJTFRFUl9BQ0NFUFQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZXNUb1Byb2Nlc3M6IHtub2RlOiBUZXh0LCBtYXRjaGVzOiBSZWdFeHBNYXRjaEFycmF5fVtdID0gW107XG4gICAgICAgICAgICAgICAgbGV0IG5vZGU6IFRleHQgfCBudWxsO1xuICAgICAgICAgICAgICAgIGxldCBub2RlQ291bnQgPSAwO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHdoaWxlIChub2RlID0gd2Fsa2VyLm5leHROb2RlKCkgYXMgVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlQ291bnQrKztcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hSZXN1bHQgPSBub2RlLnRleHRDb250ZW50Py5tYXRjaCgvKD86XnxcXHMpKEBbYS16QS1aXHUwNDMwLVx1MDQ0Rlx1MDQxMC1cdTA0MkYuLV0rKS9nKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFByb2Nlc3Npbmcgbm9kZSAke25vZGVDb3VudH06YCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbm9kZS50ZXh0Q29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoUmVzdWx0XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2hSZXN1bHQgJiYgbWF0Y2hSZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb1Byb2Nlc3MucHVzaCh7bm9kZSwgbWF0Y2hlczogbWF0Y2hSZXN1bHR9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBGb3VuZCAke25vZGVzVG9Qcm9jZXNzLmxlbmd0aH0gbm9kZXMgd2l0aCBtZW50aW9uc2ApO1xuXG4gICAgICAgICAgICAgICAgbm9kZXNUb1Byb2Nlc3MuZm9yRWFjaCgoe25vZGUsIG1hdGNoZXN9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwb3MgPSAwO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdGV4dCA9IG5vZGUudGV4dENvbnRlbnQgfHwgJyc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXMuZm9yRWFjaCgobWF0Y2g6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRleHQgYmVmb3JlIHRoZSBtZW50aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGVhbk1hdGNoID0gbWF0Y2gucmVwbGFjZSgvXlxccyovLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiZWZvcmVUZXh0ID0gdGV4dC5zbGljZShwb3MsIHRleHQuaW5kZXhPZihtYXRjaCwgcG9zKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmVmb3JlVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZChiZWZvcmVUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBtZW50aW9uIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lbnRpb25FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnRpb25FbC5hZGRDbGFzcygnbWVudGlvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVudGlvbkVsLmFkZENsYXNzKCdtZW50aW9uLXRhZycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVudGlvbkVsLnRleHRDb250ZW50ID0gY2xlYW5NYXRjaDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnRpb25FbC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZW50aW9uRWwuc2V0QXR0cmlidXRlKCdkYXRhLW1lbnRpb24nLCBjbGVhbk1hdGNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgdGhlIG1lbnRpb24gYmVmb3JlIGFkZGluZyB0aGUgY2xpY2sgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0ZXh0LmluZGV4T2YobWF0Y2gsIHBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZW50aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGNsZWFuTWF0Y2gsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZTogY3R4LnNvdXJjZVBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGFkZCBpZiBub3QgYWxyZWFkeSBleGlzdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IHRoaXMubWVudGlvbnMuc29tZShtID0+IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0udGV4dCA9PT0gY2xlYW5NYXRjaCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmZpbGUgPT09IGN0eC5zb3VyY2VQYXRoICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0ucG9zaXRpb24gPT09IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBZGRpbmcgbmV3IG1lbnRpb246JywgbWVudGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW50aW9ucy5wdXNoKG1lbnRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZURhdGEodGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsaWNrSGFuZGxlciA9IGFzeW5jIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0NsaWNrIGhhbmRsZXIgY2FsbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ01lbnRpb24gY2xpY2tlZDonLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoOiBjbGVhbk1hdGNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsVGV4dDogY2xlYW5NYXRjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoVGV4dDogY2xlYW5NYXRjaC5zbGljZSgxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2hvd01lbnRpb25SZXN1bHRzKGNsZWFuTWF0Y2guc2xpY2UoMSkpOyAvLyBSZW1vdmUgQCBzeW1ib2xcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnRpb25FbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZW50aW9uRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGlja0hhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFnbWVudC5hcHBlbmQobWVudGlvbkVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHRleHQuaW5kZXhPZihtYXRjaCwgcG9zKSArIG1hdGNoLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGFueSByZW1haW5pbmcgdGV4dFxuICAgICAgICAgICAgICAgICAgICBpZiAocG9zIDwgdGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZCh0ZXh0LnNsaWNlKHBvcykpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgbm9kZS5yZXBsYWNlV2l0aChmcmFnbWVudCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHZpZXcgYW5kIHNhdmUgZGF0YSBpZiBtZW50aW9ucyB3ZXJlIGZvdW5kXG4gICAgICAgICAgICAgICAgaWYgKG5vZGVzVG9Qcm9jZXNzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZvdW5kIG5ldyBtZW50aW9ucywgY3VycmVudCBzdGF0ZTonLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdNZW50aW9uczogbm9kZXNUb1Byb2Nlc3MubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxNZW50aW9uczogdGhpcy5tZW50aW9ucy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZW50aW9uc0RhdGE6IHRoaXMubWVudGlvbnNcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tZW50aW9uc1ZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVudGlvbnNWaWV3LnNldE1lbnRpb25zKHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2F2aW5nIG1lbnRpb25zIHRvIHN0b3JhZ2UuLi4nKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ01lbnRpb25zIHNhdmVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGZvciBib3RoIG5vcm1hbCBwcmV2aWV3IGFuZCBsaXZlIHByZXZpZXdcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IocHJvY2Vzc29yKTtcblxuICAgICAgICAgICAgLy8gUmVnaXN0ZXIgZXZlbnRzIGZvciBmaWxlIG1vZGlmaWNhdGlvbnNcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbihcIm1vZGlmeVwiLCBhc3luYyAoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRmlsZSBtb2RpZmllZDonLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgZmlsZSBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQcm9jZXNzaW5nIGZpbGUgY29udGVudCBmb3IgbWVudGlvbnMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIG9sZCBtZW50aW9ucyBmb3IgdGhpcyBmaWxlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnRpb25zID0gdGhpcy5tZW50aW9ucy5maWx0ZXIobSA9PiBtLmZpbGUgIT09IGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgYWxsIG1lbnRpb25zIGluIHRoZSBmaWxlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gY29udGVudC5tYXRjaCgvKD86XnxcXHMpKEBbYS16QS1aXHUwNDMwLVx1MDQ0Rlx1MDQxMC1cdTA0MkYuLV0rKS9nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZvdW5kIG1lbnRpb25zIGluIGZpbGU6JywgbWF0Y2hlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyBtZW50aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuTWF0Y2ggPSBtYXRjaC5yZXBsYWNlKC9eXFxzKi8sICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBjb250ZW50LmluZGV4T2YobWF0Y2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogY2xlYW5NYXRjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXBkYXRlZCBtZW50aW9uczonLCB0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHZpZXcgYW5kIHNhdmVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1lbnRpb25zVmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubWVudGlvbnNWaWV3LnNldE1lbnRpb25zKHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBSZWdpc3RlciBmb3IgZmlsZSBkZWxldGlvblxuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKFwiZGVsZXRlXCIsIGFzeW5jIChmaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGaWxlIGRlbGV0ZWQ6JywgZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBtZW50aW9ucyBmcm9tIHRoZSBkZWxldGVkIGZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJlZm9yZUNvdW50ID0gdGhpcy5tZW50aW9ucy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnRpb25zID0gdGhpcy5tZW50aW9ucy5maWx0ZXIobSA9PiBtLmZpbGUgIT09IGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZW1vdmVkQ291bnQgPSBiZWZvcmVDb3VudCAtIHRoaXMubWVudGlvbnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3ZlZENvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBSZW1vdmVkICR7cmVtb3ZlZENvdW50fSBtZW50aW9ucyBmcm9tIGRlbGV0ZWQgZmlsZTpgLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB2aWV3IGFuZCBzYXZlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubWVudGlvbnNWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubWVudGlvbnNWaWV3LnNldE1lbnRpb25zKHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEFsc28gcmVnaXN0ZXIgZm9yIGZpbGUgY3JlYXRpb25cbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbihcImNyZWF0ZVwiLCBhc3luYyAoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTmV3IGZpbGUgY3JlYXRlZDonLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gY29udGVudC5tYXRjaCgvKD86XnxcXHMpKEBbYS16QS1aXHUwNDMwLVx1MDQ0Rlx1MDQxMC1cdTA0MkYuLV0rKS9nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcy5mb3JFYWNoKG1hdGNoID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xlYW5NYXRjaCA9IG1hdGNoLnJlcGxhY2UoL15cXHMqLywgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGNvbnRlbnQuaW5kZXhPZihtYXRjaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVudGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBjbGVhbk1hdGNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZTogZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHZpZXcgYW5kIHNhdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tZW50aW9uc1ZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5tZW50aW9uc1ZpZXcuc2V0TWVudGlvbnModGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5tZW50aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gUmVnaXN0ZXIgZm9yIGZpbGUgcmVuYW1lXG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQub24oXCJyZW5hbWVcIiwgYXN5bmMgKGZpbGUsIG9sZFBhdGgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUgcmVuYW1lZDonLCB7IG9sZFBhdGgsIG5ld1BhdGg6IGZpbGUucGF0aCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIGZpbGUgcGF0aHMgaW4gbWVudGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVudGlvbnMgPSB0aGlzLm1lbnRpb25zLm1hcChtZW50aW9uID0+IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbnRpb24uZmlsZSA9PT0gb2xkUGF0aCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB7IC4uLm1lbnRpb24sIGZpbGU6IGZpbGUucGF0aCB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbWVudGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHZpZXcgYW5kIHNhdmVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1lbnRpb25zVmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubWVudGlvbnNWaWV3LnNldE1lbnRpb25zKHRoaXMubWVudGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLm1lbnRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBBZGQgY2xpY2sgaGFuZGxlciBmb3IgbWVudGlvbnNcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGV2dC50YXJnZXQgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldC5oYXNDbGFzcygnbWVudGlvbi10YWcnKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtZW50aW9uVGV4dCA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1lbnRpb25UZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3BlbiBzZWFyY2ggcGFuZWwgd2l0aCB0aGUgbWVudGlvbiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWFyY2hMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnc2VhcmNoJylbMF0gfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hMZWFmLnNldFZpZXdTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlYXJjaCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGU6IHsgcXVlcnk6IG1lbnRpb25UZXh0IH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihzZWFyY2hMZWFmKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTWVudGlvbnNQbHVnaW4gbG9hZGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZHVyaW5nIE1lbnRpb25zUGx1Z2luIGluaXRpYWxpemF0aW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIGluaXRpYWxpemluZyBNZW50aW9ucyBwbHVnaW4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZGV0YWNoTGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9NRU5USU9OUyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkZWNvcmF0ZU1lbnRpb25zKCkge1xuICAgICAgICByZXR1cm4gU3RhdGVGaWVsZC5kZWZpbmU8RGVjb3JhdGlvblNldD4oe1xuICAgICAgICAgICAgY3JlYXRlOiAoKSA9PiBEZWNvcmF0aW9uLm5vbmUsXG4gICAgICAgICAgICB1cGRhdGU6IChkZWNvcmF0aW9ucywgdHIpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gdHIuc3RhdGUuZG9jLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHRleHQubWF0Y2goLyg/Ol58XFxzKShAW2EtekEtWlx1MDQzMC1cdTA0NEZcdTA0MTAtXHUwNDJGLi1dKykvZyk7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVjb3JhdGlvbkFycmF5OiBhbnlbXSA9IFtdO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBvcyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXMuZm9yRWFjaCgobWF0Y2g6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZnVsbE1hdGNoID0gbWF0Y2g7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGVhbk1hdGNoID0gbWF0Y2gucmVwbGFjZSgvXlxccyovLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IHRleHQuaW5kZXhPZihmdWxsTWF0Y2gsIHBvcykgKyAoZnVsbE1hdGNoLmxlbmd0aCAtIGNsZWFuTWF0Y2gubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFydCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kID0gc3RhcnQgKyBjbGVhbk1hdGNoLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZW50aW9uTWFyayA9IERlY29yYXRpb24ubWFyayh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcIm1lbnRpb24gbWVudGlvbi10YWdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogeyBcImRhdGEtbWVudGlvblwiOiBjbGVhbk1hdGNoIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNvcmF0aW9uQXJyYXkucHVzaChtZW50aW9uTWFyay5yYW5nZShzdGFydCwgZW5kKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gZW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gRGVjb3JhdGlvbi5zZXQoZGVjb3JhdGlvbkFycmF5LCB0cnVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcm92aWRlOiAoZmllbGQpID0+IEVkaXRvclZpZXcuZGVjb3JhdGlvbnMuZnJvbShmaWVsZClcbiAgICAgICAgfSk7XG4gICAgfVxufSAiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBcUJPO0FBRVAsa0JBQWtFO0FBQ2xFLG1CQUF3QztBQU14QyxJQUFNLG1CQUEyQztBQUFBLEVBQzdDLFdBQVc7QUFDZjtBQUVBLElBQU0sY0FBTixNQUFrQjtBQUFBLEVBR2QsWUFBWSxVQUFtQixPQUFPO0FBQ2xDLFNBQUssVUFBVTtBQUFBLEVBQ25CO0FBQUEsRUFFQSxXQUFXLFNBQWtCO0FBQ3pCLFNBQUssVUFBVTtBQUFBLEVBQ25CO0FBQUEsRUFFQSxPQUFPLE1BQWE7QUFDaEIsUUFBSSxLQUFLLFNBQVM7QUFDZCxjQUFRLElBQUkscUJBQXFCLEdBQUcsSUFBSTtBQUFBLElBQzVDO0FBQUEsRUFDSjtBQUNKO0FBRUEsSUFBTSxxQkFBTixjQUFpQyxpQ0FBaUI7QUFBQSxFQUc5QyxZQUFZLFFBQXdCO0FBQ2hDLFVBQU0sT0FBTyxLQUFLLE1BQU07QUFDeEIsU0FBSyxTQUFTO0FBQUEsRUFDbEI7QUFBQSxFQUVBLFVBQWdCO0FBQ1osVUFBTSxFQUFFLFlBQVksSUFBSTtBQUN4QixnQkFBWSxNQUFNO0FBRWxCLFFBQUksd0JBQVEsV0FBVyxFQUNsQixRQUFRLFlBQVksRUFDcEIsUUFBUSxxQ0FBcUMsRUFDN0MsVUFBVSxZQUFVLE9BQ2hCLFNBQVMsS0FBSyxPQUFPLFNBQVMsU0FBUyxFQUN2QyxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxZQUFZO0FB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
